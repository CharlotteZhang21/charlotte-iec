!function e(t,a,i){function n(s,r){if(!a[s]){if(!t[s]){var h="function"==typeof require&&require;if(!r&&h)return h(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var d=a[s]={exports:{}};t[s][0].call(d.exports,function(e){var a=t[s][1][e];return n(a||e)},d,d.exports,e,t,a,i)}return a[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)n(i[s]);return n}({1:[function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var n=e("./states/boot"),o=i(n),s=e("./states/endcard"),r=i(s),h=e("./states/preloader"),l=i(h),d=new Phaser.Game(document.body.clientWidth*window.devicePixelRatio,document.body.clientHeight*window.devicePixelRatio,Phaser.CANVAS,"game",null,!0);d.state.add("boot",new o.default),d.state.add("endcard",new r.default),d.state.add("preloader",new l.default),d.state.start("boot")},{"./states/boot":7,"./states/endcard":8,"./states/preloader":9}],2:[function(e,t,a){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),o=function(){function e(){i(this,e),this.audios=[],this.canPlay=!1}return n(e,[{key:"enableAudio",value:function(){this.canPlay=!0}},{key:"pauseAllAudio",value:function(){this.audioController.muteAll()}},{key:"initAudio",value:function(e,t){null==this.audios[e]&&(this.audios[e]=new Audio(t),this.audios[e].muted=!0)}},{key:"play",value:function(e,t,a){this.canPlay&&(null==this.audios[e]?this.audios[e]=new Audio(t):(this.initAudioArgs(e,a),this.audios[e].play(),void 0!==a&&void 0!==a.volume&&(this.audios[e].volume=a.volume)))}},{key:"fadeOut",value:function(e){null!=this.audios[e]&&this.audios[e].fadeOut()}},{key:"pause",value:function(e){null!=this.audios[e]&&this.audios[e].pause()}},{key:"mute",value:function(e){null!=this.audios[e]&&(this.audios[e].muted=!0)}},{key:"muteAll",value:function(){for(var e in this.audios)this.audios.hasOwnProperty(e)&&(this.audios[e].pause(),this.audios[e].muted=!0)}},{key:"unmuteAll",value:function(){for(var e in this.audios)this.audios.hasOwnProperty(e)&&(this.audios[e].muted=!1)}},{key:"initAudioArgs",value:function(e,t){this.audios[e].muted=!1,this.audios[e].autoplay=!0,void 0!==t&&void 0!==t.loop&&"boolean"==typeof t.loop&&(this.audios[e].loop=t.loop)}}]),e}();a.default=o},{}],3:[function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(a,"__esModule",{value:!0});var h=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),l=e("../utils/container-util"),d=n(l),c=e("../utils/util"),u=n(c),g=e("../prefabs/custom-text"),p=i(g),y=e("../prefabs/fox"),m=i(y),f=e("../utils/tweener"),v=n(f),w=e("../utils/particles-util"),C=n(w),b=function(e){function t(e,a){o(this,t);var i=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.fallSpeed=200,i.args=a,i.initSignals(),i.canPick=!0,i.pause=!1,i.candies=[],i.autoTriggerCandies=[],i.randomUpgrade=[],i.removeMap=[],i.initBackground(a.board),i.initCandies(a.board),i.initSounds(),i.game.input.onDown.add(i.candySelect,i),i.game.input.onUp.add(i.candyDeselect,i),i.selectedCandy=null,i.resize(),void 0!==PiecSettings.helperFeature&&1==PiecSettings.helperFeature&&i.randomHelper(),i.createMessage(),i.createHand(),void 0!==PiecSettings.showPrompt&&PiecSettings.showPrompt&&i.createPrompt(),i}return r(t,e),h(t,[{key:"createPrompt",value:function(){this.prompt=new p.default(this.game,{text:"Match the",container:"prompt",anchor:PiecSettings.prompt.anchor,style:PiecSettings.prompt.style,autolocalise:!0}),this.prompt.show();var e=this.prompt.scale.x;this.prompt.angleTween=this.game.add.tween(this.prompt).to({angle:-2},500,Phaser.Easing.Quadratic.InOut,!0,0).yoyo(!0).loop(2),this.prompt.scaleTween=this.game.add.tween(this.prompt.scale).to({x:1.1*e,y:1.1*e},500,Phaser.Easing.Quadratic.InOut,!0,0).yoyo(!0).loop(2),this.game.time.events.add(2e3,function(){this.game.tweens.remove(this.prompt.angleTween),this.game.tweens.remove(this.prompt.scaleTween),this.game.add.tween(this.prompt).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,100),this.game.add.tween(this.prompt.scale).to({x:.01,y:.01},200,Phaser.Easing.Quadratic.InOut,!0,0)},this),this.prompt2=new p.default(this.game,{text:"paws",container:"prompt2",anchor:PiecSettings.prompt.anchor,style:PiecSettings.prompt.style,autolocalise:!0}),this.prompt2.show();var e=this.prompt2.scale.x;this.prompt2.angleTween=this.game.add.tween(this.prompt2).to({angle:-2},500,Phaser.Easing.Quadratic.InOut,!0,0).yoyo(!0).loop(2),this.prompt2.scaleTween=this.game.add.tween(this.prompt2.scale).to({x:1.1*e,y:1.1*e},500,Phaser.Easing.Quadratic.InOut,!0,0).yoyo(!0).loop(2),this.game.time.events.add(2e3,function(){this.game.tweens.remove(this.prompt2.angleTween),this.game.tweens.remove(this.prompt2.scaleTween),this.game.add.tween(this.prompt2).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,100),this.game.add.tween(this.prompt2.scale).to({x:.01,y:.01},200,Phaser.Easing.Quadratic.InOut,!0,0)},this)}},{key:"createHand",value:function(){this.hand=new Phaser.Sprite(this.game,0,0,"hand"),this.add(this.hand),d.fitInContainer(this.hand,"hand",0,0),this.hand.anchor.set(.1,.1);var e=this.candyAt(this.args.hand[0][0],this.args.hand[0][1]),t=this.candyAt(this.args.hand[1][0],this.args.hand[1][1]),a=e.x,i=e.y,n=t.x,o=t.y,s=this.hand.scale.x;this.hand.x=a,this.hand.y=i,this.handAnimationCancelled=!1,this.game.add.tween(this.hand).to({x:n,y:o},2e3,Phaser.Easing.Quadratic.InOut,!0,0),this.hand.positionTween=this.game.add.tween(this.hand).to({x:[a,a,n,n,a],y:[i,i,o,o,i],angle:[0,-5,-5,-5,0]},2e3,Phaser.Easing.Quadratic.InOut,!0,0).onComplete.add(function(){this.handAnimationCancelled||(this.hand.positionTween=this.game.add.tween(this.hand).to({x:[a,a,n,n,a],y:[i,i,o,o,i],angle:[0,-5,-5,-5,0],alpha:[1,1,1,1,1,0]},2e3,Phaser.Easing.Quadratic.InOut,!0,0))},this),this.hand.scaleTween=this.game.add.tween(this.hand.scale).to({x:[s,.9*s,.9*s,s,s],y:[s,.9*s,.9*s,s,s]},2e3,Phaser.Easing.Quadratic.InOut,!0,0).onComplete.add(function(){this.handAnimationCancelled||(this.hand.scaleTween=this.game.add.tween(this.hand.scale).to({x:[s,.9*s,.9*s,s,s],y:[s,.9*s,.9*s,s,s]},2e3,Phaser.Easing.Quadratic.InOut,!0,0))},this)}},{key:"cancelHand",value:function(){void 0!==this.hand.positionTween&&(this.game.tweens.remove(this.hand.positionTween),this.handAnimationCancelled=!0),void 0!==this.hand.scaleTween&&(this.game.tweens.remove(this.hand.scaleTween),this.handAnimationCancelled=!0),this.game.add.tween(this.hand).to({alpha:0},200,Phaser.Easing.Quadratic.InOut,!0,0)}},{key:"createMessage",value:function(){this.message=new Phaser.Sprite(this.game,0,0,"omgenie"),this.game.add.existing(this.message),d.fitInContainer(this.message,"message",.5,.5),this.message.initialScale=this.message.scale.x,this.message.initialY=this.message.y,this.message.initialHeight=this.message.height,this.message.alpha=0}},{key:"animateMessage",value:function(){this.message.alpha=1,this.message.scale.x=.01,this.message.scale.y=.01,this.message.y=this.message.initialY;var e=Math.random(),t=e>.66?"omgenie":e>.33?"genieous":"gemazing";this.message.loadTexture(t),this.game.add.tween(this.message.scale).to({x:this.message.initialScale,y:this.message.initialScale},500,Phaser.Easing.Back.Out,!0,0),this.game.add.tween(this.message).to({y:this.message.initialY-this.message.initialHeight,alpha:[1,1,1,1,1,0]},800,Phaser.Easing.Quadratic.InOut,!0,200),this.playMessage("compliment-text")}},{key:"initSounds",value:function(){this.game.audioController.initAudio("land1",PiecSettings.assetsDir+"land1.mp3"),this.game.audioController.initAudio("special_candy_created",PiecSettings.assetsDir+"special_candy_created.mp3"),this.game.audioController.initAudio("special_candy_created_2",PiecSettings.assetsDir+"special_candy_created_2.mp3"),this.game.audioController.initAudio("line_blast",PiecSettings.assetsDir+"line_blast.mp3"),this.game.audioController.initAudio("match1",PiecSettings.assetsDir+"match1.mp3"),this.game.audioController.initAudio("match2",PiecSettings.assetsDir+"match2.mp3"),this.game.audioController.initAudio("match3",PiecSettings.assetsDir+"match3.mp3"),this.game.audioController.initAudio("match4",PiecSettings.assetsDir+"match4.mp3"),this.game.audioController.initAudio("match5",PiecSettings.assetsDir+"match5.mp3"),this.game.audioController.initAudio("pop_sound",PiecSettings.assetsDir+"land1.mp3"),this.game.audioController.initAudio("bomb",PiecSettings.assetsDir+"bomb_sound.mp3"),this.game.audioController.initAudio("compliment-text",PiecSettings.assetsDir+"compliment-text.mp3"),this.game.audioController.initAudio("chest_opened",PiecSettings.assetsDir+"chest_opened.mp3"),this.game.audioController.initAudio("fox_move",PiecSettings.assetsDir+"fox_move.mp3"),this.game.audioController.initAudio("magic_time_appear",PiecSettings.assetsDir+"magic_time_appear.mp3")}},{key:"initSignals",value:function(){this.onCandySelect=new Phaser.Signal,this.onSuccess=new Phaser.Signal,this.onRespawnFinished=new Phaser.Signal}},{key:"randomHelper",value:function(){this.game.time.events.loop(2*Phaser.Timer.SECOND,function(){if(this.canPick&&!this.pause){var e=this.getRandomCandy();null==e||-1==e||e.fixed||"colorbomb"==e.type||"_paw"==e.type||this.upgradeCandy(e)}},this)}},{key:"upgradeCandy",value:function(e){var t=Math.floor(2*Math.random())+3;this.randomUpgrade=[],this.randomUpgrade[0]=e.col,this.randomUpgrade[1]=e.row,this.randomUpgrade[2]=t,this.canPick=!1,this.handleMatches(),this.matchInBoard()||(this.canPick=!0)}},{key:"resize",value:function(){d.fitInContainer(this,this.args.container,0,0);var e=this.getCandyOnFoxPath(this.foxCurrentAt);e.scale.x=1.5*this.getCandyOnFoxPath(this.foxCurrentAt+1).width/(e.width/e.scale.x),e.scale.y=e.scale.x;var t=this.getCandyOnFoxPath(this.foxPathArray.length-1);t.scale.x=this.getCandyOnFoxPath(this.foxCurrentAt+1).width/(e.width/e.scale.x),t.scale.y=t.scale.x}},{key:"initCandies",value:function(e){for(var t=0;t<e.length;t++)for(var a=0;a<e[0].length;a++)if(t==this.foxPathArray[this.foxCurrentAt].row&&a==this.foxPathArray[this.foxCurrentAt].column)this.createCandy("fox",a,t);else if(t==this.foxPathArray[this.foxPathArray.length-1].row&&a==this.foxPathArray[this.foxPathArray.length-1].column)this.createCandy("chest",a,t);else{var i="";t==Math.floor(e.length/2)&&a==Math.floor(e[0].length/2)&&(i="_paw"),this.createCandy(e[t][a],a,t,i)}this.onRespawnFinished.add(function(){if(!this.pause&&!this.finished){if(this.matchInBoard()||this.thereAreAutoTriggerCandies())this.game.time.events.add(250,function(){console.log(this.autoTriggerCandies),this.handleMatches()},this);else{this.canPick=!0,this.animateMessage();var e=this.getCandyOnFoxPath(this.foxCurrentAt);null!=e&&"fox"==e.id&&e.getPaws()>0&&(this.canPick=!1,this.moveFox())}this.setSelectedCandiesToNull()}},this),this.bringToTop(this.getCandyOnFoxPath(this.foxCurrentAt))}},{key:"createCandy",value:function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=i;if(0!=e){8==e&&(e="colorbomb",n="colorbomb",i="");var o=e;if(o+=i,"fox"!=e&&"chest"!=e){var s=new Phaser.Sprite(this.game,0,0,o);s.anchor.set(.5),s.id=e,this.add(s),s.x=this.getTileXFromCol(t),s.y=this.getTileYFromRow(a)}else if("fox"==e){var s=new m.default(this.game);d.fitInContainer(s,"fox"),s.fixed=!0,s.id="fox",this.add(s),s.x=this.getTileXFromCol(t),s.y=this.getTileYFromRow(a),s.onAnimationFinish.add(function(){if(this.isColorbombMatch()||this.isSpecialCandyMatch()&&!this.pause)this.handleMatches();else{var e=this.matchInBoard();this.pause||(e?this.game.time.events.add(100,function(){this.playSoundMatch(),this.handleMatches()},this):this.game.time.events.add(100,function(){this.canPick=!0},this),this.setSelectedCandiesToNull())}},this)}else if("chest"==e){var s=new Phaser.Sprite(this.game,0,0,"chest");s.fixed=!0,s.anchor.set(.5),s.id=e,this.add(s),s.x=this.getTileXFromCol(t),s.y=this.getTileYFromRow(a)}return s.col=t,s.row=a,s.type=n,this.candies[t+","+a]=s,"colorbomb"==e&&this.idleColorbomb(s),s}}},{key:"getTileXFromCol",value:function(e){return e*this.tileWidth+this.tileWidth/2}},{key:"getTileYFromRow",value:function(e){return e*this.tileWidth+this.tileWidth/2}},{key:"initBackground",value:function(e){var t,a;this.topRow=[];for(var i=0;i<e.length;i++)for(var n=0;n<e[0].length;n++)0!=e[i][n]&&(null==this.topRow[n]&&(this.topRow[n]=i),a=i%2==0?n%2==0?"board-bg-1":"board-bg-2":n%2!=0?"board-bg-1":"board-bg-2",t=new Phaser.Sprite(this.game,0,0,a),t.anchor.set(.5),t.x=(n+.5)*t.height,t.y=(i+.5)*t.width,this.add(t),this.tileWidth=t.width);this.createFoxPath(e)}},{key:"checkDirection",value:function(e,t,a){var i=e+1;if(this.foxPath[i][0]==t){if(this.foxPath[i][1]==a+1)return"r";if(this.foxPath[i][1]==a-1)return"l";console.log("ERROR: foxPath wrong ")}else if(this.foxPath[i][1]==a){if(this.foxPath[i][0]==t+1)return"d";if(this.foxPath[i][0]==t-1)return"u"}}},{key:"candySelect",value:function(e){var t=e.clientX*window.devicePixelRatio,a=e.clientY*window.devicePixelRatio;this.animateParticlesOnTouch(t,a),this.cancelHand(),this.canPick&&(this.onCandySelect.dispatch(),this.pickedCandy=this.candyAt(this.getColFromXCoord(t),this.getRowFromYCoord(a)),-1==this.pickedCandy||this.pickedCandy.fixed||(null==this.selectedCandy||void 0==this.selectedCandy?(this.selectedCandy=this.pickedCandy,this.game.input.addMoveCallback(this.candyMove,this)):this.selectedCandy==this.pickedCandy?this.selectedCandy=null:this.areNext(this.pickedCandy,this.selectedCandy)?this.swapCandies(this.selectedCandy,this.pickedCandy,!0):(console.log("NOT NEXT TO EACH OTHER"),this.selectedCandy=null,this.pickedCandy=null)))}},{key:"areNext",value:function(e,t){return Math.abs(e.row-t.row)+Math.abs(e.col-t.col)==1}},{key:"candyDeselect",value:function(e){this.game.input.deleteMoveCallback(this.candyMove,this)}},{key:"candyMove",value:function(e,t,a){if(this.canPick&&null!=this.selectedCandy){var i=t-this.selectedCandy.world.x,n=a-this.selectedCandy.world.y,o=0,s=0;Math.abs(i)>this.getGlobalTileSize()/2?s=i>0?1:-1:Math.abs(n)>this.getGlobalTileSize()/2&&(o=n>0?1:-1),o+s!=0&&(this.pickedCandy=this.candyAt(this.getColFromXCoord(this.selectedCandy.world.x)+s,this.getRowFromYCoord(this.selectedCandy.world.y)+o),-1==this.pickedCandy||this.pickedCandy.fixed||(this.swapCandies(this.selectedCandy,this.pickedCandy,!0),this.game.input.deleteMoveCallback(this.candyMove,this)))}}},{key:"swapCandies",value:function(e,t,a){this.canPick=!1;var i=e.col,n=e.row;if(e.col=t.col,e.row=t.row,t.col=i,t.row=n,this.candies[e.col+","+e.row]=e,this.candies[t.col+","+t.row]=t,"fox"!=e.id)var o=this.game.add.tween(e).to({x:this.getTileXFromCol(e.col),y:this.getTileYFromRow(e.row)},300,Phaser.Easing.Quadratic.InOut,!0);else{var s=!1;"chest"==t.id&&(s=!0),e.addMove(-1);var o=e.moveTo(this.getTileXFromCol(e.col),this.getTileYFromRow(e.row),600,0,this.checkDirection(this.foxCurrentAt-1,t.row,t.col),s);this.playFoxMove()}this.game.add.tween(t).to({x:this.getTileXFromCol(t.col),y:this.getTileYFromRow(t.row)},300,Phaser.Easing.Quadratic.InOut,!0).onComplete.add(function(){"chest"==t.id&&(t.destroy(),this.candies[t.col+","+t.row]=null,this.canPick=!1)},this);o.onComplete.add(function(){if("fox"==e.id)e.getPaws()>0&&this.foxCurrentAt<this.foxPathArray.length-1&&this.game.time.events.add(500,function(){this.moveFox()},this);else if(this.isColorbombMatch()||this.isSpecialCandyMatch()&&!this.pause)this.handleMatches();else{var i=this.matchInBoard();i||!a||this.pause?this.pause||(i?this.game.time.events.add(100,function(){this.playSoundMatch(),this.handleMatches()},this):this.game.time.events.add(100,function(){this.canPick=!0},this),this.setSelectedCandiesToNull()):this.swapCandies(e,t,!1)}},this)}},{key:"handleMatches",value:function(){this.removeMap=[];for(var e=0;e<this.args.board.length;e++){this.removeMap[e]=[];for(var t=0;t<this.args.board[0].length;t++)this.removeMap[e].push(0)}this.handleRandomUpgrades(),this.handleAutoTriggerCandies(),this.handleColorBombMatches(),this.handleSpecialCandyMatches(),this.handleHorizontalMatches(),this.handleVerticalMatches(),this.destroyCandies()}},{key:"handleRandomUpgrades",value:function(){this.randomUpgrade.length>0&&(this.removeMap[this.randomUpgrade[1]][this.randomUpgrade[0]]=this.randomUpgrade[2],this.randomUpgrade=[])}},{key:"handleAutoTriggerCandies",value:function(){if(this.thereAreAutoTriggerCandies()){for(var e=0;e<this.autoTriggerCandies.length;e++)if("_hor"==this.autoTriggerCandies[e].type)this.applyHorizontalCombo(this.autoTriggerCandies[e]);else if("_ver"==this.autoTriggerCandies[e].type)this.applyVerticalCombo(this.autoTriggerCandies[e]);else if("_wrap"==this.autoTriggerCandies[e].type)this.removeMap[this.autoTriggerCandies[e].row][this.autoTriggerCandies[e].col]=1,this.applyWrappedCandyCombo(this.autoTriggerCandies[e].col,this.autoTriggerCandies[e].row);else if("_fish"==this.autoTriggerCandies[e].type)this.removeMap[this.autoTriggerCandies[e].row][this.autoTriggerCandies[e].col]=1,this.applyFishCandyCombo(this.autoTriggerCandies[e]);else if("colorbomb"==this.autoTriggerCandies[e].type){this.removeMap[this.autoTriggerCandies[e].row][this.autoTriggerCandies[e].col]=1;var t=this.getRandomCandy();-1!=t&&this.applyColorBombCombo(this.autoTriggerCandies[e],t)}this.autoTriggerCandies=[]}}},{key:"handleSpecialCandyMatches",value:function(){if(null!=this.selectedCandy&&null!=this.pickedCandy&&this.isSpecialCandyMatch())if(this.isStripedStripedMatch())"_ver"==this.selectedCandy.type&&"_hor"==this.pickedCandy.type?(this.applyHorizontalCombo(this.pickedCandy),this.applyVerticalCombo(this.selectedCandy)):"_hor"==this.selectedCandy.type&&"_ver"==this.pickedCandy.type?(this.applyHorizontalCombo(this.selectedCandy),this.applyVerticalCombo(this.pickedCandy)):"_ver"==this.selectedCandy.type&&"_ver"==this.pickedCandy.type?(this.pickedCandy.type="_hor",this.applyHorizontalCombo(this.pickedCandy),this.applyVerticalCombo(this.selectedCandy)):"_hor"==this.selectedCandy.type&&"_hor"==this.pickedCandy.type&&(this.pickedCandy.type="_ver",this.applyHorizontalCombo(this.selectedCandy),this.applyVerticalCombo(this.pickedCandy));else if(this.isFishFishMatch())this.applyFishCandyCombo(this.selectedCandy),this.applyFishCandyCombo(this.pickedCandy);else if(this.isWrapWrapMatch())this.applyWrappedCandyCombo(this.selectedCandy.col,this.selectedCandy.row),this.applyWrappedCandyCombo(this.pickedCandy.col,this.pickedCandy.row),this.removeMap[this.selectedCandy.row][this.selectedCandy.col]=1,this.removeMap[this.pickedCandy.row][this.pickedCandy.col]=1;else if(this.isStripedWrapMatch()){this.applyHorizontalCombo(this.selectedCandy,1.3,!1);var e=this.candyAt(this.selectedCandy.col,this.selectedCandy.row-1);-1!=e&&this.applyHorizontalCombo(e,1.3,!1);var t=this.candyAt(this.selectedCandy.col,this.selectedCandy.row+1);-1!=t&&this.applyHorizontalCombo(t,1.3,!1),this.applyVerticalCombo(this.selectedCandy,1.4,!1);var a=this.candyAt(this.selectedCandy.col-1,this.selectedCandy.row);-1!=a&&this.applyVerticalCombo(a,1.4,!1);var i=this.candyAt(this.selectedCandy.col+1,this.selectedCandy.row);-1!=i&&this.applyVerticalCombo(i,1.4,!1),this.removeMap[this.selectedCandy.row][this.selectedCandy.col]=1.2,this.removeMap[this.pickedCandy.row][this.pickedCandy.col]=1,this.pickedCandy.type=""}else this.isStripedFishMatch()||this.isWrapFishMatch()?"_fish"==this.selectedCandy.type?(this.applyFishCandyCombo(this.selectedCandy,this.pickedCandy.type),this.pickedCandy.type="",this.removeMap[this.pickedCandy.row][this.pickedCandy.col]=1):"_fish"==this.pickedCandy.type&&(this.applyFishCandyCombo(this.pickedCandy,this.selectedCandy.type),this.selectedCandy.type="",this.removeMap[this.selectedCandy.row][this.selectedCandy.col]=1):this.isColorbombMatch()||(this.applyHorizontalCombo(this.selectedCandy),this.applyVerticalCombo(this.selectedCandy))}},{key:"isWrapFishMatch",value:function(){return"_wrap"==this.selectedCandy.type&&"_fish"==this.pickedCandy.type||"_wrap"==this.pickedCandy.type&&"_fish"==this.selectedCandy.type}},{key:"isStripedWrapMatch",value:function(){return("_hor"==this.selectedCandy.type||"_ver"==this.selectedCandy.type)&&"_wrap"==this.pickedCandy.type||("_hor"==this.pickedCandy.type||"_ver"==this.pickedCandy.type)&&"_wrap"==this.selectedCandy.type}},{key:"isStripedFishMatch",value:function(){return("_hor"==this.selectedCandy.type||"_ver"==this.selectedCandy.type)&&"_fish"==this.pickedCandy.type||("_hor"==this.pickedCandy.type||"_ver"==this.pickedCandy.type)&&"_fish"==this.selectedCandy.type}},{key:"isStripedStripedMatch",value:function(){return!("_hor"!=this.selectedCandy.type&&"_ver"!=this.selectedCandy.type||"_ver"!=this.pickedCandy.type&&"_hor"!=this.pickedCandy.type)}},{key:"isFishFishMatch",value:function(){return"_fish"==this.selectedCandy.type&&"_fish"==this.pickedCandy.type}},{key:"isWrapWrapMatch",value:function(){return"_wrap"==this.selectedCandy.type&&"_wrap"==this.pickedCandy.type}},{key:"applyHorizontalCombo",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.row,n=0;n<this.args.board[0].length;n++){var o=this.candyAt(n,i);-1!=o&&a&&("_fish"==o.type?this.applyFishCandyCombo(o,t,!1):"_ver"==o.type?this.applyVerticalCombo(o,t,!1):"_wrap"==o.type?this.applyWrappedCandyCombo(o.col,o.row,t,!1):"colorbomb"==o.type&&this.applyColorBombCombo(o)),this.removeMap[i][n]=t}}},{key:"applyVerticalCombo",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.col,n=0;n<this.args.board.length;n++){var o=this.candyAt(i,n);-1!=o&&a&&("_fish"==o.type?this.applyFishCandyCombo(o,t,!1):"_hor"==o.type?this.applyHorizontalCombo(o,t,!1):"_wrap"==o.type?this.applyWrappedCandyCombo(o.col,o.row,t,!1):"colorbomb"==o.type&&this.applyColorBombCombo(o)),this.removeMap[n][i]=t}}},{key:"createFoxPath",value:function(e){var t=new Phaser.Group(this.game);this.add(t);var a,i,n,o,s=0,r=0;this.foxPathArray=[],u.isPortrait()?this.foxPath=PiecSettings.foxPathPortrait:this.foxPath=PiecSettings.foxPathLandscape;for(var h=0;h<e.length;h++)for(var l=0;l<e[0].length;l++)if(r=0,s<=this.foxPath.length-1&&h==this.foxPath[s][0]&&l==this.foxPath[s][1]){if(i="way",0==s||s==this.foxPath.length-1)null==n?(a=this.checkDirection(s,h,l),n=a,"l"==a?r=180:"u"==a?r=90:"d"==a&&(r=270)):"r"==a?r=180:"u"==a?r=270:"d"==a&&(r=90),i+="_end";else if(a=this.checkDirection(s,h,l),n==a)i+="_straight","u"!=a&&"d"!=a||(r=90);else{i+="_turn";var d=n+a;"rd"==d||"ul"==d?r=270:"ul"==d||"rd"==d?r=180:"dr"!=d&&"lu"!=d||(r=90)}o=new Phaser.Sprite(this.game,0,0,i),o.anchor.set(.5),o.x=(l+.5)*o.height,o.y=(h+.5)*o.width,o.angle=r,this.add(o),this.tileWidth=o.width,o.row=h,o.column=l,this.foxPathArray.push(o),n=a,s++}this.foxCurrentAt=0}},{key:"getCandyOnFoxPath",value:function(e){return void 0!=this.foxPathArray[e]?this.candyAt(this.foxPathArray[e].column,this.foxPathArray[e].row):null}},{key:"applyFishCandyCombo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.removeMap[e.row][e.col]=1;var i=this.getRandomNonRemovingCandy();"_ver"==t?this.applyVerticalCombo(i,1.6,a):"_hor"==t?this.applyHorizontalCombo(i,1.6,a):"_wrap"==t&&this.applyWrappedCandyCombo(i.col,i.row,1.6,a),""!=i.type&&("colorbomb"==i.type?this.applyColorBombCombo(i,e):"_hor"==i.type?this.applyHorizontalCombo(i,1.6,!1):"_ver"==i.type?this.applyVerticalCombo(i,1.6,!1):"_wrap"==i.type&&this.applyWrappedCandyCombo(i,1.6,!1)),void 0!==this.removeMap[i.row][i.col]&&null!=this.removeMap[i.row][i.col]&&(this.removeMap[i.row][i.col]=1.6,e.goTo=[],e.goTo.x=i.x,e.goTo.y=i.y,e.play=t)}},{key:"applyColorBombCombo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null!=t||-1!=(t=this.getRandomCandy()))if(e.type!=t.type)for(var a=0;a<this.args.board.length;a++)for(var i=0;i<this.args.board[0].length;i++){var n=this.candyAt(i,a);if(-1!=n&&n.id==t.id)if(this.removeMap[a][i]=1.1,n.rayTo=[],n.rayTo.x=e.x,n.rayTo.y=e.y,""==t.type)"_ver"==n.type?this.applyVerticalCombo(n,1.1,!1):"_hor"==n.type?this.applyHorizontalCombo(n,1.1,!1):"_wrap"==n.type?this.applyWrappedCandyCombo(n.col,n.row,1.1,!1):"_fish"==n.type&&this.applyFishCandyCombo(n,1.1,!1);else if("_hor"==t.type||"_ver"==t.type){var o=Math.random()>.5?1:0;this.removeMap[a][i]=2.1+o}else"_wrap"==t.type?this.removeMap[a][i]=4.1:"_fish"==t.type&&(this.removeMap[a][i]=6.1)}else for(var a=0;a<this.args.board.length;a++)for(var i=0;i<this.args.board[0].length;i++){var n=this.candyAt(i,a);if(-1!=n)if(this.removeMap[a][i]=1.1,n.rayTo=[],n.rayTo.x=e.x,n.rayTo.y=e.y,n.rayTo2=[],n.rayTo2.x=t.x,n.rayTo2.y=t.y,""==t.type)"_ver"==n.type?this.applyVerticalCombo(n,1.1,!1):"_hor"==n.type?this.applyHorizontalCombo(n,1.1,!1):"_wrap"==n.type?this.applyWrappedCandyCombo(n.col,n.row,1.1,!1):"_fish"==n.type&&this.applyFishCandyCombo(n,1.1,!1);else if("_hor"==t.type||"_ver"==t.type){var o=Math.random()>.5?1:0;this.removeMap[a][i]=2.1+o}else"_wrap"==t.type?this.removeMap[a][i]=4.1:"_fish"==t.type&&(this.removeMap[a][i]=6.1)}}},{key:"applyWrappedCandyCombo",value:function(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.5,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=t-1;n<=t+1;n++){if(-1!=this.candyAt(e-1,n)){var o=this.candyAt(e-1,n);-1!=o&&i&&("_fish"==o.type?this.applyFishCandyCombo(o,a,!1):"_hor"==o.type?this.applyHorizontalCombo(o,a,!1):"_ver"==o.type?this.applyVerticalCombo(o,a,!1):"colorbomb"==o.type&&this.applyColorBombCombo(o)),this.removeMap[n][e-1]=a}if(-1!=this.candyAt(e,n)){var o=this.candyAt(e,n);-1!=o&&i&&("_fish"==o.type?this.applyFishCandyCombo(o,a,!1):"_hor"==o.type?this.applyHorizontalCombo(o,a,!1):"_ver"==o.type?this.applyVerticalCombo(o,a,!1):"colorbomb"==o.type&&this.applyColorBombCombo(o)),this.removeMap[n][e]=a}if(-1!=this.candyAt(e+1,n)){var o=this.candyAt(e+1,n);-1!=o&&i&&("_fish"==o.type?this.applyFishCandyCombo(o,a,!1):"_hor"==o.type?this.applyHorizontalCombo(o,a,!1):"_ver"==o.type?this.applyVerticalCombo(o,a,!1):"colorbomb"==o.type&&this.applyColorBombCombo(o)),this.removeMap[n][e+1]=a}}}},{key:"handleColorBombMatches",value:function(){null!=this.selectedCandy&&null!=this.pickedCandy&&(this.isColorbombMatch()&&(this.removeMap[this.selectedCandy.row][this.selectedCandy.col]=1,this.removeMap[this.pickedCandy.row][this.pickedCandy.col]=1),"colorbomb"==this.selectedCandy.type&&"colorbomb"==this.pickedCandy.type?this.applyColorBombCombo(this.selectedCandy,this.pickedCandy):("colorbomb"==this.selectedCandy.type&&this.applyColorBombCombo(this.selectedCandy,this.pickedCandy),"colorbomb"==this.pickedCandy.type&&this.applyColorBombCombo(this.pickedCandy,this.selectedCandy)))}},{key:"handleHorizontalMatches",value:function(){for(var e=0;e<this.args.board.length;e++)for(var t=1,a=-1,i=0,n=[],o=[],s=[],r=[],h=0;h<this.args.board[0].length;h++)if(this.candyAt(h,e).id==a&&t++,"_hor"==this.candyAt(h,e).type&&n.push(this.candyAt(h,e)),"_ver"==this.candyAt(h,e).type&&o.push(this.candyAt(h,e)),"_wrap"==this.candyAt(h,e).type&&1.2!=this.removeMap[e][h]&&s.push(this.candyAt(h,e)),"_fish"==this.candyAt(h,e).type&&r.push(this.candyAt(h,e)),this.candyAt(h,e).id!=a||h==this.args.board[0].length-1){if(t>=3&&this.handleCombosInMatch(n,o,s,r,a),t>=5&&this.handleHorizontalColorStreakWithSpecialCandy(e,i,t,5),4==t&&this.handleHorizontalColorStreakWithSpecialCandy(e,i,t,2),3==t)for(var l=0;l<t;l++)this.removeMap[e][i+l]<1&&(this.removeMap[e][i+l]=1);i=h,t=1,a=this.candyAt(h,e).id}}},{key:"handleVerticalMatches",value:function(){for(var e=0;e<this.args.board[0].length;e++)for(var t=1,a=-1,i=0,n=[],o=[],s=[],r=[],h=0;h<this.args.board.length;h++){this.candyAt(e,h).id==a&&t++,"_hor"==this.candyAt(e,h).type&&n.push(this.candyAt(e,h)),"_ver"==this.candyAt(e,h).type&&o.push(this.candyAt(e,h)),"_wrap"==this.candyAt(e,h).type&&s.push(this.candyAt(e,h)),"_fish"==this.candyAt(e,h).type&&r.push(this.candyAt(e,h));if(this.candyAt(e,h).id!=a||h==this.args.board.length-1){if(t>=3&&this.handleCombosInMatch(n,o,s,r,a),t>=5&&this.handleVerticalColorStreakWithSpecialCandy(e,i,t,5),4==t&&this.handleVerticalColorStreakWithSpecialCandy(e,i,t,3),3==t)for(var l=0;l<t;l++)this.removeMap[i+l][e]<1&&(this.removeMap[i+l][e]=1);this.handleXCombo(e,a,i,t),i=h,t=1,a=this.candyAt(e,h).id}}}},{key:"handleCombosInMatch",value:function(e,t,a,i,n){if(e.length>0)for(var o=0;o<e.length;o++)e[o].id==n&&this.applyHorizontalCombo(e[o]);if(t.length>0)for(var o=0;o<t.length;o++)t[o].id==n&&this.applyVerticalCombo(t[o]);if(a.length>0)for(var o=0;o<a.length;o++)a[o].id==n&&this.applyWrappedCandyCombo(a[o].col,a[o].row);if(i.length>0)for(var o=0;o<i.length;o++)i[o].id==n&&this.applyFishCandyCombo(i[o])}},{key:"getRandomNonRemovingCandy",value:function(){for(var e=Math.floor(Math.random()*this.removeMap[0].length),t=Math.floor(Math.random()*this.removeMap.length),a=this.candyAt(e,t),i=0;i<10;i++){var e=Math.floor(Math.random()*this.removeMap[0].length),t=Math.floor(Math.random()*this.removeMap.length),a=this.candyAt(e,t);if(0==this.removeMap[t][e]&&-1!=a)return a}return a}},{key:"getRandomCandy",value:function(){var e,t=Math.floor(Math.random()*this.args.board[0].length),a=Math.floor(Math.random()*this.args.board.length);return 0==this.args.board[a][t]||(e=this.candyAt(t,a)),e}},{key:"handleFishCombo",value:function(e,t,a){if(null!=a&&void 0!=a||(a=this.candyAt(e,t).id),-1==this.candyAt(e,t)||this.candyAt(e,t).id!=a||-1==this.candyAt(e-1,t)||this.candyAt(e-1,t).id!=a||-1==this.candyAt(e,t-1)||this.candyAt(e,t-1).id!=a||-1==this.candyAt(e-1,t-1)||this.candyAt(e-1,t-1).id!=a)return!1;for(var i=!1,n=t-1;n<=t;n++){for(var o=e-1;o<=e;o++)-1!=this.candyAt(o,n)&&this.candyAt(o,n).id==a&&(this.removeMap&&this.removeMap.length>0&&(this.removeMap[n][o]=1),null!=this.selectedCandy&&null!=this.pickedCandy&&(n==this.selectedCandy.row&&o==this.selectedCandy.col||n==this.pickedCandy.row&&o==this.pickedCandy.col)&&(this.removeMap&&this.removeMap.length>0&&(this.removeMap[n][o]=6),i=!0));i||this.removeMap&&this.removeMap.length>0&&(this.removeMap[t][e]=6)}return!0}},{key:"handleHorizontalColorStreakWithSpecialCandy",value:function(e,t,a,i){for(var n=!1,o=0;o<a;o++)this.removeMap[e][t+o]=1,null!=this.selectedCandy&&null!=this.pickedCandy&&(e==this.selectedCandy.row&&t+o==this.selectedCandy.col||e==this.pickedCandy.row&&t+o==this.pickedCandy.col)&&(this.removeMap[e][t+o]=i,n=!0);n||(this.removeMap[e][t+o-1]=i)}},{key:"handleVerticalColorStreakWithSpecialCandy",value:function(e,t,a,i){for(var n=!1,o=0;o<a;o++)this.removeMap[t+o][e]=1,
null!=this.selectedCandy&&null!=this.pickedCandy&&(e==this.selectedCandy.col&&t+o==this.selectedCandy.row||e==this.pickedCandy.col&&t+o==this.pickedCandy.row)&&(this.removeMap[t+o][e]=i,n=!0);n||(this.removeMap[t+o-1][e]=i)}},{key:"handleXCombo",value:function(e,t,a,i){var n=!1;if(i>=3){for(var o=!1,s=0;s<i;s++)e-2>=0&&this.candyAt(e-1,a+s).id==t&&this.candyAt(e,a+s).id==t&&this.candyAt(e-2,a+s).id==t&&(n=!0),e-1>=0&&e+1<this.args.board[0].length&&this.candyAt(e-1,a+s).id==t&&this.candyAt(e,a+s).id==t&&this.candyAt(e+1,a+s).id==t&&(n=!0),e+2<=this.args.board[0].length&&this.candyAt(e+1,a+s).id==t&&this.candyAt(e,a+s).id==t&&this.candyAt(e+2,a+s).id==t&&(n=!0),n&&null!=this.selectedCandy&&null!=this.pickedCandy&&(e==this.selectedCandy.col&&a+s==this.selectedCandy.row||e==this.pickedCandy.col&&a+s==this.pickedCandy.row)&&(this.removeMap[a+s][e]=4,o=!0);n&&!o&&(this.removeMap[a+s-1][e]=4)}}},{key:"destroyCandies",value:function(){for(var e=[],t=0,a=0;a<this.args.board.length;a++)for(var i=0;i<this.args.board[0].length;i++)if(this.removeMap[a][i]>=1&&this.removeMap[a][i]<2){var n=this.candyAt(i,a);if(n.fixed)continue;if(0==this.args.board[a][i])continue;var o;""==n.type?o=this.destroyCandy(n,this.removeMap[a][i]):"_hor"==n.type?o=this.animateStripedCandy(n,0,this.removeMap[a][i]):"_ver"==n.type?o=this.animateStripedCandy(n,90,this.removeMap[a][i]):"_wrap"==n.type?o=this.animateWrappedCandy(n,this.removeMap[a][i]):"_fish"==n.type?o=this.animateFishCandy(n,this.removeMap[a][i]):"colorbomb"==n.type?o=this.animateColorBomb(n,this.removeMap[a][i]):"_paw"==n.type?(null!=this.getCandyOnFoxPath(this.foxCurrentAt)&&this.getCandyOnFoxPath(this.foxCurrentAt).addMove(1),e.push(n),o=this.destroyCandy(n,this.removeMap[a][i])):o=this.destroyCandy(n,this.removeMap[a][i]),null==o?-1!=n&&this.autoTriggerCandies.push(n):(t++,o.onComplete.add(function(e){e.destroy(),0!=--t||this.pause||(this.makeCandiesFall(),this.respawnCandies())},this),this.candies[i+","+a]=null)}else this.removeMap[a][i]>=2&&this.removeMap[a][i]<3?this.changeCandyTo(this.candyAt(i,a),"_hor",this.removeMap[a][i]):this.removeMap[a][i]>=3&&this.removeMap[a][i]<4?this.changeCandyTo(this.candyAt(i,a),"_ver",this.removeMap[a][i]):this.removeMap[a][i]>=4&&this.removeMap[a][i]<5?this.changeCandyTo(this.candyAt(i,a),"_wrap",this.removeMap[a][i]):this.removeMap[a][i]>=5&&this.removeMap[a][i]<6?this.changeCandyTo(this.candyAt(i,a),"colorbomb"):this.removeMap[a][i]>=6&&this.removeMap[a][i]<7&&this.changeCandyTo(this.candyAt(i,a),"_paw",this.removeMap[a][i]);if(e.length>0){for(var s,a=(this.getCandyOnFoxPath(this.foxCurrentAt),0);a<e.length;a++){s=e[a];var r=new Phaser.Sprite(this.game,0,0,s.id+"_paw");r.x=s.x,r.y=s.y,r.anchor.set(.5),r.scale.x=s.width/r.width,r.scale.y=r.scale.y,this.add(r),r.bringToTop(),v.scaleAndFlyToGoal(r,this.getCandyOnFoxPath(this.foxCurrentAt).x,this.getCandyOnFoxPath(this.foxCurrentAt).y,0,800,Phaser.Easing.Quadratic.InOut).onComplete.add(function(e){this.destroyPawAnimation(r,0),e.destroy()},this)}e=[]}}},{key:"moveFox",value:function(){this.canPick=!1,++this.foxCurrentAt>=this.foxPathArray.length-1&&(this.foxCurrentAt=this.foxPathArray.length-1);var e=this.getCandyOnFoxPath(this.foxCurrentAt-1),t=this.getCandyOnFoxPath(this.foxCurrentAt);if(void 0!=t&&-1!=t&&null!=t){if("chest"==t.id){var a=new Phaser.Sprite(this.game,0,0,"chest");a.scale.x=t.width/(a.width/a.scale.x),a.scale.y=a.scale.x,a.anchor.set(.5),a.x=t.x,a.y=t.y,this.add(a),this.bringToTop(e);var i=new Phaser.Sprite(this.game,0,0,"chest");i.scale.x=1.05*t.width/(i.width/i.scale.x),i.scale.y=i.scale.x,i.anchor.set(.5),i.x=t.worldPosition.x,i.y=t.worldPosition.y,i.alpha=0,this.game.add.existing(i),this.animateChest(a,i),t.alpha=0,this.finished=!0,this.onSuccess.dispatch()}this.swapCandies(e,t)}}},{key:"animateChest",value:function(e,t){var a=(e.scale.x,new Phaser.Sprite(this.game,0,0,"chest-open"));d.fitInContainer(a,"chest-final",.5,.5),a.alpha=0,this.game.add.existing(a),this.game.time.events.add(1e3,function(){this.playAudio("magic_time_appear",{loop:!1,volume:1})},this);var i=this;this.game.time.events.add(800,function(){t.alpha=1,e.alpha=0},this),v.moveToContainer(e,"chest-final",500,800,Phaser.Easing.Quadratic.InOut),v.moveToContainer(t,"chest-final",500,800,Phaser.Easing.Quadratic.InOut,function(e){a.alpha=1,t.alpha=0,a.x=t.worldPosition.x,a.y=t.worldPosition.y;var n=a.scale.x;e.game.add.tween(a.scale).to({x:[.95*n,1.05*n,n],y:[1.05*n,.95*n,n]},500,Phaser.Easing.Quadratic.InOut,!0,0).onComplete.add(function(){v.scaleOut(a,1e3,1e3,Phaser.Easing.Quadratic.InOut)}),i.playAudio("chest_opened",{loop:!1,volume:1})},this)}},{key:"idleColorbomb",value:function(e){void 0==e.tween?this.game.add.tween(e.scale).to({x:1.1,y:1.1},600,Phaser.Easing.Quadratic.InOut,!0).loop(!0).yoyo(!0):e.tween.onComplete.add(function(){this.game.add.tween(e.scale).to({x:1.1,y:1.1},600,Phaser.Easing.Quadratic.InOut,!0).loop(!0).yoyo(!0)},this)}},{key:"changeCandyTo",value:function(e,t,a){if(null==e||-1==e)return null;var i=(a%1).toFixed(1),n=0;.6==i&&(n=1050,this.autoTriggerCandies.push(e));var o=this.game.add.tween(e.scale).to({x:[1.3,1],y:[1.3,1]},150,Phaser.Easing.Quadratic.InOut,!0,n);e.tween=o,this.game.time.events.add(n,function(){null!=e&&-1!=e&&("colorbomb"==t?(this.playSoundColorbombCreated(),void 0!==e.loadTexture&&(e.loadTexture("colorbomb"),this.idleColorbomb(e)),e.id="colorbomb"):void 0!==e.loadTexture&&e.loadTexture(e.id+t),"_wrap"==t?this.playSoundWrappedCreated():"_hor"!=t&&"_ver"!=t||this.playSoundStripedCreated(),e.type=t,.1==i&&(this.animateRay(e,e.rayTo),this.animateRay(e,e.rayTo2),n=400,this.autoTriggerCandies.push(e)))},this)}},{key:"destroyCandy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(null!=e&&-1!=e){var a=100;1.5==t?a=300:1.6==t?a=1050:1.1==t?(a=600+200*Math.random()+100,this.animateRay(e,e.rayTo),this.animateRay(e,e.rayTo2)):1.3==t?a=1200:1.4==t&&(a=600),this.destroyCandyAnimation(e,a);var i=this.game.add.tween(e).to({alpha:0},150,Phaser.Easing.Quadratic.InOut,!0,a);return this.game.add.tween(e.scale).to({x:.01,y:.01},200,Phaser.Easing.Quadratic.InOut,!0,a-100),this.animateCandyParticles(e,5,a),i}}},{key:"animateRay",value:function(e,t){if(void 0!==t){var a=new Phaser.Sprite(this.game,0,0,"colorbomb_ray");this.add(a),a.anchor.x=.5,a.anchor.y=1,a.x=t.x,a.y=t.y;var i=180/Math.PI*Math.atan2(t.y-e.y,t.x-e.x)-90;a.angle=i;var n=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),o=200*Math.random();a.alpha=0,this.game.time.events.add(o,function(){a.alpha=1},this),this.game.add.tween(a.scale).to({y:n/a.height},150,Phaser.Easing.Quadratic.InOut,!0,o),this.game.add.tween(a).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,950);var s=400*Math.random()+400;this.game.add.tween(a.scale).to({x:[2,1,1.7,.9,1.8]},s,Phaser.Easing.Quadratic.InOut,!0).loop(!0),this.game.time.events.add(200+o,function(){},this)}}},{key:"animateColorBomb",value:function(e){this.animateCandyParticles(e,10,1050);var t=this.game.add.tween(e).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,1250);return this.game.add.tween(e.scale).to({x:[1.1,.01],y:[1.1,.01]},400,Phaser.Easing.Quadratic.InOut,!0,1050),t}},{key:"destroyCandyAnimation",value:function(e,t){var a=new Phaser.Sprite(this.game,0,0,"circle");a.anchor.set(.5),a.x=e.x,a.y=e.y,this.add(a),a.scale.set(.01),this.game.add.tween(a.scale).to({x:1.2,y:1.2},450,Phaser.Easing.Quadratic.Out,!0,t),this.game.add.tween(a).to({alpha:[1,0]},150,Phaser.Easing.Quadratic.InOut,!0,300+t).onComplete.add(function(e){e.destroy()},this)}},{key:"destroyPawAnimation",value:function(e,t){var a=new Phaser.Sprite(this.game,0,0,"circle");a.anchor.set(.5),a.x=e.x,a.y=e.y,this.add(a),a.scale.set(.01),this.game.add.tween(a.scale).to({x:1.2,y:1.2},450,Phaser.Easing.Quadratic.Out,!0,t),C.particleExplosion(this.game,["star"],"particle-container","fox",e.worldPosition.x,e.worldPosition.y,3+2*Math.random()),this.game.add.tween(a).to({alpha:[1,0]},150,Phaser.Easing.Quadratic.InOut,!0,300+t).onComplete.add(function(e){e.destroy()},this)}},{key:"animateCandyParticles",value:function(e,t,a){for(var i=0;i<t;i++){var n=e.id+"_particle";if("colorbomb"==e.type){var o=Math.random()>.5?"_2":"";n=e.id+"_particle"+o}var s=new Phaser.Sprite(this.game,0,0,n);s.x=e.x,s.y=e.y,s.anchor.set(.5),this.add(s);var r=e.x+Math.random()*this.tileWidth*(Math.random()>.5?1:-1),h=e.y+Math.random()*this.tileWidth*(Math.random()>.5?1:-1),l=Math.floor(360*Math.random());s.angle=l;var d=.5*Math.random()+.5;s.scale.set(.01);var c=200*Math.random()+550,u=200*Math.random();this.game.add.tween(s).to({x:r,y:h,alpha:[1,1,1,0],angle:[l,l+270*(Math.random()-.5)]},c,Phaser.Easing.Quadratic.Out,!0,u+a),this.game.add.tween(s.scale).to({x:[d,d,d,d,1.2*d,.01],y:[d,d,d,d,1.2*d,.01]},c,Phaser.Easing.Quadratic.InOut,!0,a)}}},{key:"animateParticlesOnTouch",value:function(e,t){this.playPopSound();for(var a=0;a<10;a++){var i=Math.floor(7*Math.random()+1)+"_particle";"7_particle"==i&&(i="colorbomb_particle");var n=new Phaser.Sprite(this.game,0,0,i);n.x=e,n.y=t,n.anchor.set(.5),this.game.add.existing(n);var o=e+Math.random()*this.tileWidth*(Math.random()>.5?1:-1),s=t+Math.random()*this.tileWidth*(Math.random()>.5?1:-1),r=Math.floor(360*Math.random());n.angle=r;var h=.5*Math.random()+.5;n.scale.set(.01);var l=200*Math.random()+550,d=200*Math.random();this.game.add.tween(n).to({x:o,y:s,alpha:[1,1,1,0],angle:[r,r+270*(Math.random()-.5)]},l,Phaser.Easing.Quadratic.Out,!0,d+0),this.game.add.tween(n.scale).to({x:[h,h,h,h,1.2*h,.01],y:[h,h,h,h,1.2*h,.01]},l,Phaser.Easing.Quadratic.InOut,!0,0)}}},{key:"animateFishCandy",value:function(e,t){if(null==e.goTo)return null;var a=e.goTo.x,i=e.goTo.y;e.goTo.id=e.id;var n=e.x,o=e.y,s=a-n;this.bringToTop(e);var r=30,h=1;i<o&&(a>n?(h=-1,r-=90):r+=60),i>=o&&a>n&&(h=-1,r-=45);var l=0;1.1==t&&(l=600);var d=900+200*Math.random(),c=100*Math.random()+l;void 0!==e.loadTexture&&("_ver"==e.play?(e.loadTexture(e.id+"_sfish"),this.animateStripes(e.goTo,90,.95*d)):"_hor"==e.play?(e.loadTexture(e.id+"_sfish"),this.animateStripes(e.goTo,0,.95*d)):"_wrap"==e.play&&(e.loadTexture(e.id+"_wfish"),this.game.time.events.add(d,function(){this.playBombSound()},this))),this.game.add.tween(e).to({angle:[r,r-10,r+10,r]},d,Phaser.Easing.Quadratic.InOut,!0,c),this.game.add.tween(e.scale).to({x:[1.5*h,1.2*h,1.2*h,1.2*h,1.2*h,1.2*h,h,h,h,h,h,1.1*h,.01*h],y:[1.5,1.2,1.2,1.2,1.2,1.2,1,1,1,1,1,1.1,.01]},d,Phaser.Easing.Quadratic.InOut,!0,c),this.game.add.tween(e).to({x:[n+.4*s-this.tileWidth/10,n+.8*s+this.tileWidth/10,a],y:[i]},d,Phaser.Easing.Quadratic.InOut,!0,c);var u=this.game.add.tween(e).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,d+c);return this.game.time.events.add(d-100+c,function(){},this),u}},{key:"animateWrappedCandy",value:function(e,t){if(1.2==t)return this.animateStripedWrapCandy(e);var a=(t%1).toFixed(1),i=0;.1==a&&(this.animateRay(e,e.rayTo),this.animateRay(e,e.rayTo2),i=600),1.6==t&&(i=1050),this.game.time.events.add(450+i,function(){this.playBombSound()},this);var n=e.x;e.y;this.bringToTop(e),this.game.add.tween(e).to({x:[n-.05*n,n+.05*n,n-.05*n,n+.05*n,n-.05*n,n+.05*n,n-.05*n,n+.05*n,n-.05*n,n+.05*n,n-.05*n,n+.05*n,n-.05*n,n+.05*n,n-.05*n,n+.05*n]},500,Phaser.Easing.Quadratic.InOut,!0,i);var o=this.game.add.tween(e).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,300+i);return this.game.add.tween(e.scale).to({x:3,y:3},400,Phaser.Easing.Quadratic.Out,!0,i),o}},{key:"animateStripedWrapCandy",value:function(e){return void 0!==e.loadTexture&&e.loadTexture(e.id+"_ver"),e.type="_ver",this.game.add.tween(e.scale).to({x:4,y:4},550,Phaser.Easing.Quadratic.InOut,!0).onComplete.add(function(){void 0!==e.loadTexture&&e.loadTexture(e.id+"_hor"),e.type="_hor",e.scale.set(1),this.game.add.tween(e.scale).to({x:[4],y:[4]},600,Phaser.Easing.Quadratic.InOut,!0)},this),this.game.time.events.add(500,function(){this.playSoundStripeBlast()},this),this.game.time.events.add(1100,function(){this.playSoundStripeBlast()},this),this.animateStripes(e,90,400,2),this.animateStripes(e,0,1e3,2),this.game.add.tween(e).to({alpha:0},100,Phaser.Easing.Quadratic.InOut,!0,1200)}},{key:"animateStripedCandy",value:function(e,t,a){if(1.2==a)return this.animateStripedWrapCandy(e);this.playSoundStripeBlast();var i=(a%1).toFixed(1),n=0;.1==i?(this.animateRay(e,e.rayTo),n=600):1.3==a?n=1100:1.6==a&&(n=1050);var o=this.game.add.tween(e).to({alpha:0},250,Phaser.Easing.Quadratic.InOut,!0,50+n);return this.game.add.tween(e.scale).to({x:.01,y:.01},200,Phaser.Easing.Quadratic.InOut,!0,n),this.animateStripes(e,t,n),o}},{key:"animateStripes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=new Phaser.Sprite(this.game,0,0,e.id+"_stripes");n.anchor.set(.5),n.x=e.x,n.y=e.y,n.angle=t,n.scale.x=.01,n.scale.y=i,n.alpha=0,this.add(n),this.game.time.events.add(a,function(){n.alpha=1},this),this.game.add.tween(n.scale).to({x:5},350,Phaser.Easing.Quadratic.InOut,!0,a),this.game.add.tween(n).to({alpha:0},150,Phaser.Easing.Quadratic.InOut,!0,350+a).onComplete.add(function(e){e.destroy()},this)}},{key:"makeCandiesFall",value:function(){for(var e=0,t=this.args.board.length-2;t>=0;t--)for(var a=0;a<this.args.board[0].length;a++){var i=this.candyAt(a,t);if(-1!=i&&!i.fixed&&0!=this.args.board[t][a]){var n=this.holesBelow(a,t);if(n>0){this.fixedCandiesInCol(a)>0&&(n+=this.fixedCandiesInBetween(i.col,i.row,i.row+n));var o=i.y+n*this.tileWidth,s=this.fallSpeed*n,r=this.game.add.tween(i).to({y:[o,o-.1*this.tileWidth,o]},s,Phaser.Easing.Quadratic.Out,!0,0);e++,i.row=i.row+n,this.candies[i.col+","+i.row]=i,this.candies[a+","+t]=null,r.onComplete.add(function(t){0!=--e||this.pause||this.respawnCandies()},this),this.game.time.events.add((s+0)/3.3,function(){this.playSoundFallingCandy()},this)}}}0!=e||this.pause||this.respawnCandies()}},{key:"getTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"colorbomb"==e.type?"colorbomb":""==e.type&&t?e.id+"_blur":e.id+e.type}},{key:"holesBelow",value:function(e,t){for(var a=0,i=t+1;i<this.args.board.length;i++)-1==this.candyAt(e,i)&&0!=this.args.board[i][e]&&a++;return a}},{key:"holesInCol",value:function(e){for(var t=0,a=this.topRow[e];a<this.args.board.length;a++)-1==this.candyAt(e,a)&&0!=this.args.board[a][e]&&t++;return t}},{key:"fixedCandiesInBetween",value:function(e,t,a){for(var i=0,n=a;n>=t;n--)-1!=this.candyAt(e,n)&&this.candyAt(e,n).fixed&&i++;return i}},{key:"fixedCandiesBelow",value:function(e,t){for(var a=0,i=t+1;i<this.args.board.length;i++)-1!=this.candyAt(e,i)&&this.candyAt(e,i).fixed&&a++;return a}},{key:"fixedCandiesInCol",value:function(e){for(var t=0,a=this.topRow[e];a<this.args.board.length;a++)-1!=this.candyAt(e,a)&&this.candyAt(e,a).fixed&&t++;return t}},{key:"respawnCandies",value:function(){for(var e,t=0,a=0;a<this.args.board[0].length;a++){e=this.topRow[a];var i=this.holesInCol(a);if(i>0)for(var n=e;n<i+e;n++){var o=this.getRandomColor(),s=Math.random()>.7?"_paw":"",r=n;if(this.fixedCandiesInBetween(a,e,r)>0&&(r+=this.fixedCandiesInBetween(a,e,r)),-1==this.candyAt(a,r)){var h=this.createCandy(o,a,r,s);h.y=-this.tileWidth*(i-r)+this.tileWidth/2;var l=this.fallSpeed*i,d=50+50*(this.args.board[0].length-n),c=this.getTileYFromRow(r);this.showAfterDelay(h,d);this.game.add.tween(h).to({y:[c,.95*c,c]},l,Phaser.Easing.Quadratic.Out,!0,d);t++,this.game.time.events.add((l+d)/3.3,function(){this.playSoundFallingCandy()},this),this.game.time.events.add(.9*l,function(){null!=h&&-1!=h?0==--t&&this.onRespawnFinished.dispatch():console.log("ignored -----------------------")},this)}}}}},{key:"thereAreAutoTriggerCandies",value:function(){return this.autoTriggerCandies.length>0}},{key:"setSelectedCandiesToNull",value:function(){this.selectedCandy=null}},{key:"showAfterDelay",value:function(e,t){e.alpha=0,this.game.time.events.add(t,function(){null!=e&&-1!=e&&(e.alpha=1)},this)}},{key:"addMotionBlurEffect",value:function(e,t){}},{key:"getRandomColor",value:function(){var e=Math.random();return e<this.args.chances[0]?1:e<this.args.chances[0]+this.args.chances[1]?2:e<this.args.chances[0]+this.args.chances[1]+this.args.chances[2]?3:e<this.args.chances[0]+this.args.chances[1]+this.args.chances[2]+this.args.chances[3]?4:e<this.args.chances[0]+this.args.chances[1]+this.args.chances[2]+this.args.chances[3]+this.args.chances[4]?5:e<this.args.chances[0]+this.args.chances[1]+this.args.chances[2]+this.args.chances[3]+this.args.chances[4]+this.args.chances[5]?6:void 0}},{key:"getGlobalTileSize",value:function(){return this.tileWidth*this.scale.x}},{key:"getRowFromYCoord",value:function(e){return Math.floor((e-this.y)/this.getGlobalTileSize())}},{key:"getColFromXCoord",value:function(e){return Math.floor((e-this.x)/this.getGlobalTileSize())}},{key:"candyAt",value:function(e,t){return void 0!=this.candies[e+","+t]&&null!=this.candies[e+","+t]?this.candies[e+","+t]:-1}},{key:"isHorizontalMatch",value:function(e,t){return this.candyAt(e,t).id==this.candyAt(e-1,t).id&&this.candyAt(e,t).id==this.candyAt(e-2,t).id}},{key:"isVerticalMatch",value:function(e,t){return this.candyAt(e,t).id==this.candyAt(e,t-1).id&&this.candyAt(e,t).id==this.candyAt(e,t-2).id}},{key:"isFourMatch",value:function(e,t){return this.candyAt(e,t).id==this.candyAt(e,t-1).id&&this.candyAt(e,t).id==this.candyAt(e-1,t-1).id&&this.id==this.candyAt(e-1,t).id}},{key:"isColorbombMatch",value:function(){return null!=this.selectedCandy&&null!=this.pickedCandy&&("colorbomb"==this.selectedCandy.type||"colorbomb"==this.pickedCandy.type)}},{key:"isSpecialCandyMatch",value:function(){return null!=this.selectedCandy&&null!=this.pickedCandy&&""!=this.selectedCandy.type&&""!=this.pickedCandy.type}},{key:"isMatch",value:function(e,t){return this.isHorizontalMatch(e,t)||this.isVerticalMatch(e,t)}},{key:"matchInBoard",value:function(){for(var e=0;e<this.args.board.length;e++)for(var t=0;t<this.args.board[0].length;t++)if(0!=this.args.board[e][t]&&this.isMatch(t,e))return!0;return this.canPick=!0,!1}},{key:"playSoundMatch",value:function(){console.log("playing sound match");var e=Math.floor(4*Math.random())+1,t="match"+e,a=PiecSettings.assetsDir+"match"+e+".mp3",i={loop:!1,volume:1};this.game.audioController.play(t,a,i)}},{key:"playBombSound",value:function(){var e=PiecSettings.assetsDir+"bomb.mp3",t={loop:!1,volume:1};this.game.audioController.play("bomb",e,t)}},{key:"playSoundStripeBlast",value:function(){var e=PiecSettings.assetsDir+"line_blast.mp3",t={loop:!1,volume:1};this.game.audioController.play("line_blast",e,t)}},{key:"playMessage",value:function(e){var t=e,a=PiecSettings.assetsDir+e+".mp3",i={loop:!1,volume:.6};this.game.audioController.play(t,a,i)}},{key:"playSoundFallingCandy",value:function(){var e=PiecSettings.assetsDir+"land1.mp3",t={loop:!1,volume:1};this.game.audioController.play("land1",e,t)}},{key:"playSoundColorbomb",value:function(){var e=PiecSettings.assetsDir+"color_bomb.mp3",t={loop:!1,volume:1};this.game.audioController.play("colorbomb",e,t)}},{key:"playSoundColorbombCreated",value:function(){var e=PiecSettings.assetsDir+"special_candy_created.mp3",t={loop:!1,volume:1};this.game.audioController.play("special_candy_created",e,t)}},{key:"playSoundStripedCreated",value:function(){var e=PiecSettings.assetsDir+"special_candy_created_2.mp3",t={loop:!1,volume:1};this.game.audioController.play("special_candy_created_2",e,t)}},{key:"playSoundWrappedCreated",value:function(){var e=PiecSettings.assetsDir+"special_candy_created.mp3",t={loop:!1,volume:1};this.game.audioController.play("wrapped_created",e,t)}},{key:"playPopSound",value:function(){var e=PiecSettings.assetsDir+"pop.mp3",t={loop:!1,volume:1};this.game.audioController.play("pop_sound",e,t)}},{key:"playChestOpen",value:function(){var e=PiecSettings.assetsDir+"chest_opened.mp3",t={loop:!1,volume:1};this.game.audioController.play("chest_opened",e,t)}},{key:"playAudio",value:function(e,t){var a=PiecSettings.assetsDir+e+".mp3";this.game.audioController.play(e,a,t)}},{key:"playFoxMove",value:function(){var e=PiecSettings.assetsDir+"fox_move.mp3",t={loop:!1,volume:.5};this.game.audioController.play("fox_move",e,t)}}]),t}(Phaser.Group);a.default=b},{"../prefabs/custom-text":5,"../prefabs/fox":6,"../utils/container-util":11,"../utils/particles-util":13,"../utils/tweener":14,"../utils/util":15}],4:[function(e,t,a){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(a,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),h=e("../utils/container-util"),l=i(h),d=e("../utils/animations-util"),c=(i(d),e("../utils/custom-png-sequences-renderer.js")),u=(i(c),e("../utils/util")),g=i(u),p=function(e){function t(e,a){n(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return void 0!==a.OSsensitive&&1==a.OSsensitive&&(a.src=g.getDeviceOS()+"-"+a.src),i.args=a,i.initSignals(),void 0!==a.src&&""!=a.src?i.createButton(a):i.createInteractiveArea(a),i.button.inputEnabled=!0,i.button.input.useHandCursor=!0,i.button.events.onInputDown.add(function(){this.game.onSDKCall.dispatch(),this.game.time.events.add(50,function(){parent.postMessage("download","*")},this)},i),i.game.world.bringToTop(i),i.hide(),i.anchor=[],i.anchor.x=i.args.anchor.x,i.anchor.y=i.args.anchor.y,i}return s(t,e),r(t,[{key:"createButton",value:function(e){this.button=new Phaser.Sprite(this.game,0,0,e.src),this.button.x-=this.button.width*this.args.anchor.x,this.button.y-=this.button.height*this.args.anchor.y,this.add(this.button),this.button.bringToTop(),l.fitInContainer(this,e.container,this.args.anchor.x,this.args.anchor.y)}},{key:"createInteractiveArea",value:function(e){var t=new Phaser.Graphics(this.game,0,0);t.beginFill(16777215,0),t.drawRect(-l.getContainerWidth(e.container)*this.args.anchor.x,-l.getContainerHeight(e.container)*this.args.anchor.y,l.getContainerWidth(e.container),l.getContainerHeight(e.container)),this.button=t,this.add(this.button),l.fitInContainer(this,e.container,this.args.anchor.x,this.args.anchor.y)}},{key:"initSignals",value:function(){this.onInteract=new Phaser.Signal}},{key:"show",value:function(){this.alpha<1&&(this.alpha=1),this.button.inputEnabled=!0}},{key:"hide",value:function(){this.alpha>0&&(this.alpha=0),this.button.inputEnabled=!1}},{key:"enable",value:function(){this.button.inputEnabled||(this.button.inputEnabled=!0)}},{key:"disable",value:function(){this.button.inputEnabled&&(this.button.inputEnabled=!1)}},{key:"fitInContainer",value:function(e){l.fitInContainer(this,e,this.anchor.x,this.anchor.y)}}]),t}(Phaser.Group);a.default=p},{"../utils/animations-util":10,"../utils/container-util":11,"../utils/custom-png-sequences-renderer.js":12,"../utils/util":15}],5:[function(e,t,a){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(a,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),h=e("../utils/container-util"),l=i(h),d=e("../utils/tweener"),c=(i(d),e("../utils/util")),u=i(c),g=function(e){function t(e,a){n(this,t);var i=(a.text,0==l.getContainerHeight(a.container)?50:l.getContainerHeight(a.container));l.getContainerHeight(a.container)<=0&&console.log("ERROR height of container "+a.container+" is 0");var s={font:a.style.fontWeight+" "+i+"px "+a.style.fontFamily+","+PiecSettings.genericFontFamily},r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,0,0,a.text,s)),h=r.context.createLinearGradient(0,0,0,r.height);if(void 0!==a.style.color&&a.style.color.length>0)for(var d=0;d<a.style.color.length;d++){var c=d/a.style.color.length;h.addColorStop(c,a.style.color[d])}if(r.fill=h,void 0!==a.style.stroke&&(r.stroke=a.style.stroke),void 0!==a.style.strokeThickness&&(r.strokeThickness=a.style.strokeThickness),void 0!==a.style.shadow){var u=a.style.shadow;r.setShadow(u.x,u.y,u.color,u.blur,u.shadowStroke,u.shadowFill)}return void 0!==a.style.lineSpacing&&(r.lineSpacing=a.style.lineSpacing),r.game.add.existing(r),r.currentContainer=a.container,r.alpha=0,void 0!==a.autolocalise&&1==a.autolocalise&&void 0!==PiecSettings.translations[r.text]?r.autolocalise():r.text=" "+r.text+" ",void 0!==a.style.fontCase&&"uppercase"==a.style.fontCase&&(r.text=r.text.toUpperCase(),r.game.time.events.add(50,function(){this.text=this.text.toUpperCase()},r)),l.bestFit(r,a.container,a.anchor.x,a.anchor.y),"ja"!=r.lang&&"ko"!=r.lang&&"el"!=r.lang&&"ru"!=r.lang&&"zh"!=r.lang||(r.y+=.1*r.height),r}return s(t,e),r(t,[{key:"show",value:function(){this.alpha<1&&(this.alpha=1)}},{key:"hide",value:function(){this.alpha>0&&(this.alpha=0)}},{key:"enable",value:function(){}},{key:"disable",value:function(){}},{key:"autolocalise",value:function(){var e=u.getDeviceLang();this.lang=e,void 0!==PiecSettings.translations[this.text][e]&&(this.text=" "+PiecSettings.translations[this.text][e]+" ")}},{key:"fitInContainer",value:function(e){l.bestFit(this,e,this.anchor.x,this.anchor.y)}}]),t}(Phaser.Text);a.default=g},{"../utils/container-util":11,"../utils/tweener":14,"../utils/util":15}],6:[function(e,t,a){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(a,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),h=e("../utils/container-util"),l=(i(h),e("../utils/util")),d=(i(l),e("../prefabs/custom-text")),c=(function(e){e&&e.__esModule}(d),e("../utils/custom-png-sequences-renderer")),u=i(c),g=function(e){function t(e,a){n(this,t);var i=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.fox={},i.defaultStatus="idle",i.animationToDo=[],i.animationIndex=0,i.createFox(i.defaultStatus,!1),i.paws=0,i.canMove=!0,i.win=!1,i.initSignals(),i}return s(t,e),r(t,[{key:"initSignals",value:function(){this.onAnimationFinish=new Phaser.Signal}},{key:"addMove",value:function(e){this.paws+=e}},{key:"getPaws",value:function(){return this.paws}},{key:"resetStatus",value:function(e,t){if(e.animationToDo.shift(),e.win)e.winPlayed||(e.changeTo("win",!1),e.animationToDo=[],e.winPlayed=!0);else if(e.paws<=0||-1!=t.key.indexOf("win")){if(-1!=t.key.indexOf("win"))e.changeTo(e.defaultStatus,!1);else if(e.animationToDo.length>0&&e.animationToDo[0]!=e.defaultStatus){var a=e.animationToDo.shift();e.changeTo(a,!1)}else e.changeTo(e.defaultStatus,!1);e.onAnimationFinish.dispatch()}else e.fox[e.defaultStatus].alpha=0}},{key:"createFox",value:function(e){if(this.fox!={})for(var t in this.fox)null!=this.fox[t]&&(this.fox[t].alpha=0);this.fox[e]=u.playPngSequence(this.game,"fox-"+e,this,this.resetStatus),this.add(this.fox[e]),this.fox[e].x-=this.fox[e].width/2,this.fox[e].y-=this.fox[e].height/2}},{key:"resize",value:function(e,t,a){console.log(t,a),this.fixedScale=e,this.offsetX=t,this.offsetY=a}},{key:"getPos",value:function(){return{x:this.x,y:this.y}}},{key:"moveTo",value:function(e,t,a,i,n){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!this.win)return this.changeTo("jump-"+n),this.win=o,this.game.add.tween(this).to({x:e,y:t},a,Phaser.Easing.Quadratic.InOut,!0,i)}},{key:"changeTo",value:function(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.animationToDo.push(e),void 0!=this.fox[e]&&this.fox[e].persistent?this.fox[e].alpha=1:this.createFox(e)}}]),t}(Phaser.Group);a.default=g},{"../prefabs/custom-text":5,"../utils/container-util":11,"../utils/custom-png-sequences-renderer":12,"../utils/util":15}],7:[function(e,t,a){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(a,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),r=function(e){function t(){return i(this,t),n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),s(t,[{key:"preload",value:function(){}},{key:"init",value:function(){PiecSettings.assetsDir="dev"===PiecSettings.env?"assets/":"";var e=this.game;e.onInteract=new Phaser.Signal,e.onSDKCall=new Phaser.Signal,e.onResize=new Phaser.Signal,"undefined"!=typeof piec&&(piec.lockGame=function(){e.global.locked=!0},piec.unlockGame=function(){e.global.locked=!1},piec.destroyGame=function(){e.destroy()},piec.onSDKCall=function(){e.onSDKCall.dispatch()},piec.onResize=function(){e.onResize.dispatch()}),window.onresize=function(){e.scale.setGameSize(document.body.clientWidth*window.devicePixelRatio,document.body.clientHeight*window.devicePixelRatio),e.scale.refresh(),e.state.start("boot",!0,!1)}}},{key:"create",value:function(){this.init(),this.game.input.maxPointers=1,this.initGlobalVariables(),this.game.state.start("preloader"),this.game.onMoveStart=function(e){e.global.interactions++,PiecSettings&&PiecSettings.onMoveStart&&PiecSettings.onMoveStart(e.global.interactions)},
this.game.onMoveComplete=function(e){PiecSettings&&PiecSettings.onMoveComplete&&PiecSettings.onMoveComplete(e.global.moveStats)}}},{key:"initGlobalVariables",value:function(){this.game.global={interaction:0,gameComplete:!1,currentVideoScript:null}}}]),t}(Phaser.State);a.default=r},{}],8:[function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(a,"__esModule",{value:!0});var h=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),l=e("../utils/container-util.js"),d=n(l),c=e("../utils/custom-png-sequences-renderer"),u=(n(c),e("../utils/particles-util")),g=(n(u),e("../utils/tweener")),p=(n(g),n(g),e("../prefabs/audio-controller")),y=i(p),m=e("../prefabs/board"),f=i(m),v=e("../prefabs/cta-button"),w=i(v),C=e("../prefabs/custom-text"),b=i(C),x=function(e){function t(){return o(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return r(t,e),h(t,[{key:"create",value:function(){this.game.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.game.scale.setUserScale(1/window.devicePixelRatio,1/window.devicePixelRatio,0,0),this.game.global.windowWidth=document.body.clientWidth*window.devicePixelRatio,this.game.global.windowHeight=document.body.clientHeight*window.devicePixelRatio,this.game.onSDKCall.add(this.mute,this),this.game.onResize.add(this.resize,this),this.game.stage.disableVisibilityChange=!0;var e=Math.min(Math.floor(Math.random()*PiecSettings.boards.length),PiecSettings.boards.length-1);void 0!==PiecSettings.fixedBoard&&(e=PiecSettings.fixedBoard);var t=PiecSettings.boards[e],a=PiecSettings.hand[e],i=PiecSettings.chances[e];this.isLandscape()&&(e=Math.min(Math.floor(Math.random()*PiecSettings.boards_l.length),PiecSettings.boards_l.length-1),void 0!==PiecSettings.fixedBoard&&(e=PiecSettings.fixedBoard),t=PiecSettings.boards_l[e],a=PiecSettings.hand_l[e],i=PiecSettings.chances_l[e]),this.game.audioController=new y.default,this.game.input.onDown.add(function(){this.game.time.events.add(500,function(){this.game.audioController.enableAudio()},this)},this),this.board=new f.default(this.game,{container:"board-container",board:t,hand:a,chances:i}),this.endcardPlayed=!1,this.board.onSuccess.add(function(){this.game.time.events.add(1e3,function(){this.endcardPlayed||(this.endcard(),this.endcardPlayed=!0,this.game.time.events.add(2500,function(){console.log("complete"),parent.postMessage("complete","*")},this))},this)},this),this.game.add.existing(this.board),this.createCta(),this.createLogo(),this.endcardCounter()}},{key:"isLandscape",value:function(){return this.game.global.windowWidth>this.game.global.windowHeight}},{key:"endcardCounter",value:function(){void 0!==PiecSettings.endcardAfterXSeconds&&this.game.time.events.add(1e3*PiecSettings.endcardAfterXSeconds,function(){this.endcardPlayed||(this.endcard(),this.endcardPlayed=!0,this.game.time.events.add(2500,function(){console.log("complete"),parent.postMessage("complete","*")},this))},this)}},{key:"endcard",value:function(){this.board.pause=!0,this.game.time.events.add(500,function(){this.animateChars(),this.animateBoard(),this.animateLogo(),this.animateCandies(),this.finalAnimationCta()},this)}},{key:"animateChars",value:function(){var e=new Phaser.Sprite(this.game,0,0,"characters");this.game.add.existing(e),d.fitInContainer(e,"characters",.5,.5),this.game.add.existing(e),this.game.world.bringToTop(this.game.cta),this.game.world.bringToTop(this.game.ctaText);var t=e.y,a=e.scale.x;e.scale.x*=.1,e.scale.y=e.scale.x,e.y=d.getContainerY("chest-final"),this.characters=e,this.game.add.tween(e.scale).to({x:a,y:a},1e3,Phaser.Easing.Quadratic.InOut,!0,0).onComplete.add(function(){this.game.add.tween(e).to({y:[t+.15*e.height]},1e3,Phaser.Easing.Quadratic.InOut,!0,0).yoyo(0,!0)},this)}},{key:"animateCandies",value:function(){var e=[];e[0]="1",e[1]="2",e[2]="3",e[3]="4",e[4]="5",e[5]="6",e[6]="colorbomb",this.game.time.events.add(500,function(){this.board.playSoundFallingCandy(),this.game.time.events.add(75,function(){this.board.playPopSound()},this),this.game.time.events.add(150,function(){this.board.playPopSound()},this),this.game.time.events.add(30,function(){this.board.playPopSound()},this)},this);for(var t=0;t<30;t++){var a=this.getRandomParticleFromArray(this.game,e);d.fitInContainer(a,"particle",.5,.5);var i=Math.random()>.5?-1:1,n=Math.random()>.5?-1:1;a.x=this.characters.x+Math.random()/2*i*this.logoWidth/1.5,a.y=this.characters.y+Math.random()/2*n*this.logoWidth/4;var o=90*Math.random();a.angle=o;var s=.5*Math.random()+1;a.scale.x*=s,a.scale.y=a.scale.x,this.game.add.existing(a);var r=100*Math.random(),h=600+100*Math.random(),l=a.scale.x*(1.5*Math.random()),c=Math.random()/2*i,u=a.y-a.height*(8*Math.random()+.5);h+=.3*Math.abs(u-this.logo.y);var g=a.x+c*a.width*10,p=this.game.global.windowHeight+a.height;a.scale.x*=.2,a.scale.y*=.2,this.game.add.tween(a.scale).to({x:l,y:l},h,Phaser.Easing.Quadratic.InOut,!0,r),this.game.add.tween(a).to({alpha:[1,1,1,1,1,1],x:g,y:[u,p],angle:180*Math.random()},h,Phaser.Easing.Quadratic.InOut,!0,r).interpolation(Phaser.Math.bezierInterpolation).onComplete.add(function(e){e.destroy()})}}},{key:"getRandomParticleFromArray",value:function(e,t){var a=Math.min(Math.floor(Math.random()*t.length),t.length-1),i=t[a];return new Phaser.Sprite(e,0,0,i)}},{key:"animateBoard",value:function(){var e=this.board.y;this.game.add.tween(this.board).to({alpha:0,y:[e,e-100]},500,Phaser.Easing.Quadratic.InOut,!0)}},{key:"finalAnimationCta",value:function(){this.game.tweens.remove(this.game.cta.tween),this.game.tweens.remove(this.game.ctaText.tween),this.isLandscape()&&(this.game.add.tween(this.game.cta).to({x:this.game.global.windowWidth/2},500,Phaser.Easing.Quadratic.InOut,!0,0),this.game.add.tween(this.game.ctaText).to({x:this.game.global.windowWidth/2},500,Phaser.Easing.Quadratic.InOut,!0,0)),this.game.cta.tween=this.game.add.tween(this.game.cta.scale).to({x:1.2*this.game.cta.initialScale,y:1.2*this.game.cta.initialScale},400,Phaser.Easing.Quadratic.InOut,!0,0),(this.game.ctaText.tween=this.game.add.tween(this.game.ctaText.scale).to({x:1.2*this.game.ctaText.initialScale,y:1.2*this.game.ctaText.initialScale},400,Phaser.Easing.Quadratic.InOut,!0,0)).onComplete.add(function(){this.game.cta.tween=this.game.add.tween(this.game.cta.scale).to({x:1.3*this.game.cta.initialScale,y:1.3*this.game.cta.initialScale},400,Phaser.Easing.Quadratic.InOut,!0,0).loop(!0).yoyo(!0),this.game.ctaText.tween=this.game.add.tween(this.game.ctaText.scale).to({x:1.3*this.game.ctaText.initialScale,y:1.3*this.game.ctaText.initialScale},400,Phaser.Easing.Quadratic.InOut,!0,0).loop(!0).yoyo(!0)},this)}},{key:"createLogo",value:function(){this.logo=new Phaser.Sprite(this.game,0,0,"logo"),this.game.add.existing(this.logo),d.fitInContainer(this.logo,"logo",.5,.5),this.logoWidth=this.logo.width,this.logo.alpha=0}},{key:"animateLogo",value:function(){this.logo.alpha=1;var e=this.logo.scale.x;this.logo.scale.x=.01,this.logo.scale.y=.01,this.game.add.tween(this.logo.scale).to({x:e,y:e},500,Phaser.Easing.Back.Out,!0,300)}},{key:"createCta",value:function(){var e=new w.default(this.game,{src:"btn-yellow",container:"cta",anchor:{x:.5,y:.5}});this.game.add.existing(e),e.show();var t=new b.default(this.game,{text:PiecSettings.ctaText.text,container:"cta-text",anchor:PiecSettings.ctaText.anchor,style:PiecSettings.ctaText.style,autolocalise:!0});this.add.existing(t),t.show(),this.game.cta=e,this.game.ctaText=t;var a=e.scale.x;this.game.cta.initialScale=a,this.game.cta.tween=this.game.add.tween(e.scale).to({x:1.05*a,y:1.05*a},1e3,Phaser.Easing.Quadratic.InOut,!0,0).loop(!0).yoyo(!0);var i=t.scale.x;this.game.ctaText.initialScale=i,this.game.ctaText.tween=this.game.add.tween(t.scale).to({x:1.05*i,y:1.05*i},1e3,Phaser.Easing.Quadratic.InOut,!0,0).loop(!0).yoyo(!0)}},{key:"initSignals",value:function(){}},{key:"resize",value:function(){}},{key:"render",value:function(){}},{key:"update",value:function(){}},{key:"mute",value:function(){}},{key:"onGameComplete",value:function(){}}]),t}(Phaser.State);a.default=x},{"../prefabs/audio-controller":2,"../prefabs/board":3,"../prefabs/cta-button":4,"../prefabs/custom-text":5,"../utils/container-util.js":11,"../utils/custom-png-sequences-renderer":12,"../utils/particles-util":13,"../utils/tweener":14}],9:[function(e,t,a){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(a,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),h=e("../utils/util"),l=(i(h),e("../utils/custom-png-sequences-renderer.js")),d=i(l),c=function(e){function t(){n(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.preloadAsset=!1,e.ready=!1,e}return s(t,e),r(t,[{key:"preload",value:function(){this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.loadResources(),this.game.load.image("1",PiecSettings.assetsDir+"red.png"),this.game.load.image("2",PiecSettings.assetsDir+"blue.png"),this.game.load.image("3",PiecSettings.assetsDir+"yellow.png"),this.game.load.image("4",PiecSettings.assetsDir+"green.png"),this.game.load.image("5",PiecSettings.assetsDir+"orange.png"),this.game.load.image("6",PiecSettings.assetsDir+"purple.png"),this.game.load.image("1_hor",PiecSettings.assetsDir+"red_hor.png"),this.game.load.image("2_hor",PiecSettings.assetsDir+"blue_hor.png"),this.game.load.image("3_hor",PiecSettings.assetsDir+"yellow_hor.png"),this.game.load.image("4_hor",PiecSettings.assetsDir+"green_hor.png"),this.game.load.image("5_hor",PiecSettings.assetsDir+"orange_hor.png"),this.game.load.image("6_hor",PiecSettings.assetsDir+"purple_hor.png"),this.game.load.image("1_ver",PiecSettings.assetsDir+"red_ver.png"),this.game.load.image("2_ver",PiecSettings.assetsDir+"blue_ver.png"),this.game.load.image("3_ver",PiecSettings.assetsDir+"yellow_ver.png"),this.game.load.image("4_ver",PiecSettings.assetsDir+"green_ver.png"),this.game.load.image("5_ver",PiecSettings.assetsDir+"orange_ver.png"),this.game.load.image("6_ver",PiecSettings.assetsDir+"purple_ver.png"),this.game.load.image("1_wrap",PiecSettings.assetsDir+"red_wrap.png"),this.game.load.image("2_wrap",PiecSettings.assetsDir+"blue_wrap.png"),this.game.load.image("3_wrap",PiecSettings.assetsDir+"yellow_wrap.png"),this.game.load.image("4_wrap",PiecSettings.assetsDir+"green_wrap.png"),this.game.load.image("5_wrap",PiecSettings.assetsDir+"orange_wrap.png"),this.game.load.image("6_wrap",PiecSettings.assetsDir+"purple_wrap.png"),this.game.load.image("1_paw",PiecSettings.assetsDir+"red_paw.png"),this.game.load.image("2_paw",PiecSettings.assetsDir+"blue_paw.png"),this.game.load.image("3_paw",PiecSettings.assetsDir+"yellow_paw.png"),this.game.load.image("4_paw",PiecSettings.assetsDir+"green_paw.png"),this.game.load.image("5_paw",PiecSettings.assetsDir+"orange_paw.png"),this.game.load.image("6_paw",PiecSettings.assetsDir+"purple_paw.png"),this.game.load.image("magic_cloud",PiecSettings.assetsDir+"magic_cloud.png"),this.game.load.image("1_stripes",PiecSettings.assetsDir+"zoom_red.png"),this.game.load.image("2_stripes",PiecSettings.assetsDir+"zoom_blue.png"),this.game.load.image("3_stripes",PiecSettings.assetsDir+"zoom_yellow.png"),this.game.load.image("4_stripes",PiecSettings.assetsDir+"zoom_green.png"),this.game.load.image("5_stripes",PiecSettings.assetsDir+"zoom_orange.png"),this.game.load.image("6_stripes",PiecSettings.assetsDir+"zoom_purple.png"),this.game.load.image("1_particle",PiecSettings.assetsDir+"red_particle.png"),this.game.load.image("2_particle",PiecSettings.assetsDir+"blue_particle.png"),this.game.load.image("3_particle",PiecSettings.assetsDir+"yellow_particle.png"),this.game.load.image("4_particle",PiecSettings.assetsDir+"green_particle.png"),this.game.load.image("5_particle",PiecSettings.assetsDir+"orange_particle.png"),this.game.load.image("6_particle",PiecSettings.assetsDir+"purple_particle.png"),this.game.load.image("colorbomb",PiecSettings.assetsDir+"colorbomb.png"),this.game.load.image("colorbomb_particle",PiecSettings.assetsDir+"colorbomb_particle.png"),this.game.load.image("colorbomb_particle_2",PiecSettings.assetsDir+"colorbomb_particle_2.png"),this.game.load.image("colorbomb_ray",PiecSettings.assetsDir+"colorbomb_ray.png"),this.game.load.image("circle",PiecSettings.assetsDir+"burst.png"),this.game.load.image("board-bg-1",PiecSettings.assetsDir+"board-bg-1.png"),this.game.load.image("board-bg-2",PiecSettings.assetsDir+"board-bg-2.png"),this.game.load.image("way_turn",PiecSettings.assetsDir+"way_turn.png"),this.game.load.image("way_straight",PiecSettings.assetsDir+"way_straight.png"),this.game.load.image("way_end",PiecSettings.assetsDir+"way_end.png"),this.game.load.image("hand",PiecSettings.assetsDir+"hand.png"),this.game.load.image("logo",PiecSettings.assetsDir+"logo.png"),this.game.load.image("chest",PiecSettings.assetsDir+"chest.png"),this.game.load.image("chest-open",PiecSettings.assetsDir+"chest-open.png"),this.game.load.image("star",PiecSettings.assetsDir+"star.png"),this.game.load.image("btn-yellow",PiecSettings.assetsDir+"btn_green.png"),this.game.load.image("characters",PiecSettings.assetsDir+"characters.png"),this.game.load.image("omgenie",PiecSettings.assetsDir+"omgenie.png"),this.game.load.image("genieous",PiecSettings.assetsDir+"genieous.png"),this.game.load.image("gemazing",PiecSettings.assetsDir+"gemazing.png"),this.game.load.image("hand",PiecSettings.assetsDir+"hand.png"),this.game.load.image("prompt",PiecSettings.assetsDir+"prompt.png")}},{key:"update",value:function(){this.ready&&this.game.state.start("endcard")}},{key:"loadResources",value:function(){d.preloadPngSequences(this.game),this.preloadAsset||this.onLoadComplete()}},{key:"onLoadComplete",value:function(){this.ready=!0}}]),t}(Phaser.State);a.default=c},{"../utils/custom-png-sequences-renderer.js":12,"../utils/util":15}],10:[function(e,t,a){"use strict";function i(){return p=new Phaser.Signal}function n(e,t){e.loopReverse&&(e.animations.currentAnim.isReversed=!0),0!=t.loopCount&&t.loopCount==e.numberOfLoops&&(e.persistent||(e.alpha=0,t.loop=!1,p.dispatch(e)))}function o(e,t,a,i,n,o){if(t.loopReverse=n,t.speed=i,t.loopReverse)e.time.events.add(a,function(){t.alpha=1,t.animations.play("animation",i,!1),t.animations.currentAnim.onComplete.add(s,this)});else{var h=void 0!==o||o>=0;e.time.events.add(a,function(){t.alpha=1,t.animations.play("animation",i,h),h||t.animations.currentAnim.onComplete.add(r,this)})}}function s(e,t){e.animations.currentAnim.isReversed=!e.animations.currentAnim.isReversed,e.animations.play("animation",e.speed,!1)}function r(e,t){e.persistent||(e.alpha=0)}function h(e,t,a,i,s,r,h,l,d,c,u,g){for(var p=c.offsetWidth*window.devicePixelRatio,y=c.offsetHeight*window.devicePixelRatio,m=c.offsetLeft*window.devicePixelRatio,f=c.offsetTop*window.devicePixelRatio,v=p/100,w=y/100,C=[],b=0;b<t.length;b++){var x=u.add.sprite(m+t[b]*v,f+a[b]*w,e);g.add(x),x.anchor.set(r),x.animations.add("animation"),x.alpha=0,x.persistent=d,o(u,x,i[b],h,!1,s[b]),x.scale.x=p*l[b]/100/x.width,x.scale.y=x.scale.x,C.push(x),null!=s&&(x.numberOfLoops=s[b],x.animations.currentAnim.onLoop.add(n,this))}return C}function l(e,t,a,i,n,o){var s=t.scale.x;t.scale.x=.01,t.scale.y=.01,e.time.events.add(i,function(){e.add.tween(t.scale).to({x:s,y:s},a,Phaser.Easing.Back.Out,!0,0).onComplete.add(function(){e.time.events.add(n,function(){e.add.tween(t).to({alpha:0},a,Phaser.Easing.Quadratic.In,!0,0).onComplete.add(function(){t.destroy()},this)},this)},this)},this)}function d(e,t,a,i,n,o,s,r){e.time.events.add(s,function(){t.alpha=1,e.add.tween(t).to({y:i,x:a},o,r,!0,0),e.add.tween(t.scale).to({x:n,y:n},o,r,!0,0)},this),e.time.events.add(9e3+s,function(){e.add.tween(t).to({alpha:0},1e3,Phaser.Easing.Quadratic.InOut,!0,0),e.time.events.add(1e3,function(){t.destroy()},this)},this)}function c(e,t,a,i,n,o,s,r){e.time.events.add(s,function(){t.alpha=0,e.add.tween(t).to({alpha:[.5,1,0],y:i,x:a,angle:180},o,r,!0,0),e.add.tween(t.scale).to({x:n,y:n},o,r,!0,0)},this)}function u(e,t,a,i,n,o,s){this.starFloatWithDelayCustom(e,t,a,i,n,o,s,Phaser.Easing.Quadratic.Out)}function g(e,t,a,i,n,o){for(var s=Math.random()>.5?1:-1,r=50*Math.random()+30,h=0;h<20;h++){var l=new Phaser.Sprite(game,0,0,t);l.x=e.x,l.y=e.y,l.scale.x=e.x/1.5/l.width,l.scale.y=l.scale.x,l.alpha=0,l.anchor.set(.5);var d=l.scale.x,c=n+200*Math.random(),u=20*h+o,g=l.x;game.add.tween(l).to({x:[g+Math.random()*r*s,this.goal.getXCoordOfGoal(index)-Math.random()*r*s,this.goal.getXCoordOfGoal(index)],y:this.goal.getYCoordOfGoal(index),alpha:[1,1,1,1,0]},c,Phaser.Easing.Quadratic.InOut,!0,u).interpolation(function(e,t){return Phaser.Math.catmullRomInterpolation(e,t)}).onComplete.add(function(e){e.destroy()},this),game.add.tween(l.scale).to({x:[1.1*d,d,d,.5*d],y:[1.1*d,d,d,.5*d]},c,Phaser.Easing.Quadratic.InOut,!0,u),this.fxLayer.add(l)}}Object.defineProperty(a,"__esModule",{value:!0}),a.initSignal=i,a.onLoop=n,a.playAnimation=o,a.onComplete=s,a.onCompleteNoLooping=r,a.playAnimations=h,a.spawnAndDissapear=l,a.starFloatWithDelayCustom2=d,a.starFloatWithDelayCustom=c,a.starFloatWithDelay=u,a.flyBubbleToGoal=g;var p},{}],11:[function(e,t,a){"use strict";function i(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;n(t);var o=document.getElementById(t),s=o.offsetWidth*window.devicePixelRatio,r=o.offsetHeight*window.devicePixelRatio,h=o.getBoundingClientRect().left*window.devicePixelRatio,l=o.getBoundingClientRect().top*window.devicePixelRatio;void 0!==e.anchor&&(e.anchor.x=a,e.anchor.y=i),e.x=h+s*a,e.y=l+r*i;var d=e.scale.x;e.scale.x=s/(e.width/e.scale.x),e.scale.y=e.scale.x,e.height>r&&(e.scale.x=d,e.scale.y=d,e.scale.y=r/(e.height/e.scale.y),e.scale.x=e.scale.y)}function n(e){null==document.getElementById(e)&&console.log("ERROR: Container Name "+e+" doesn't exist in the DOM")}function o(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;n(t);var o=document.getElementById(t),s=o.offsetWidth*window.devicePixelRatio,r=o.offsetHeight*window.devicePixelRatio,h=o.getBoundingClientRect().left*window.devicePixelRatio,l=o.getBoundingClientRect().top*window.devicePixelRatio;void 0!==e.anchor&&(e.anchor.x=a,e.anchor.y=i),e.x=h+s*a,e.y=l+r*i,e.scale.x=s/(e.width/e.scale.x),e.scale.y=e.scale.x}function s(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;n(t);var o=document.getElementById(t),s=o.offsetWidth*window.devicePixelRatio,r=o.offsetHeight*window.devicePixelRatio,h=o.getBoundingClientRect().left*window.devicePixelRatio,l=o.getBoundingClientRect().top*window.devicePixelRatio;void 0!=e.anchor&&e.anchor.set(a,i),e.x=h+s*a,e.y=l+r*i,e.scale.y=r/e.height,e.scale.x=e.scale.y}function r(e,t){o(e,t),e.x+=e.width/2,e.y+=e.height/2}function h(e){return n(e),document.getElementById(e).getBoundingClientRect().top*window.devicePixelRatio}function l(e){return n(e),document.getElementById(e).getBoundingClientRect().left*window.devicePixelRatio}function d(e){return n(e),document.getElementById(e).offsetWidth*window.devicePixelRatio}function c(e){return n(e),document.getElementById(e).offsetHeight*window.devicePixelRatio}function u(e,t){n(t);var a=document.getElementById(t),i=a.offsetWidth*window.devicePixelRatio;a.offsetHeight,window.devicePixelRatio;e.scale.x=i/e.width,e.scale.y=e.scale.x}function g(e){n(e);var t=document.getElementById(e),a=t.offsetWidth*window.devicePixelRatio,i=(t.offsetHeight,window.devicePixelRatio,t.getBoundingClientRect().left*window.devicePixelRatio);t.getBoundingClientRect().top,window.devicePixelRatio;return i+Math.random()*a}function p(e){n(e);var t=document.getElementById(e),a=(t.offsetWidth,window.devicePixelRatio,t.offsetHeight*window.devicePixelRatio);t.getBoundingClientRect().left,window.devicePixelRatio;return t.getBoundingClientRect().top*window.devicePixelRatio+Math.random()*a}function y(e){n(e);var t=document.getElementById(e),a=t.offsetWidth*window.devicePixelRatio;return t.getBoundingClientRect().left*window.devicePixelRatio+a/2}function m(e){n(e);var t=document.getElementById(e),a=t.offsetHeight*window.devicePixelRatio;return t.getBoundingClientRect().top*window.devicePixelRatio+a/2}function f(e){var t={};if(t.x=e.global.windowWidth/2,t.y=e.global.windowHeight/2,-90==e.world.angle){var a=t.x;t.x=t.y,t.y=a}return t}function v(e,t,a){var i={};if(i.x=t,i.y=a,-90==e.world.angle){var n=i.x;i.x=i.y,i.y=n}return i}Object.defineProperty(a,"__esModule",{value:!0}),a.bestFit=i,a.fitInContainer=o,a.fitInContainerHeight=s,a.fitInContainerAnchorAtCenter=r,a.getContainerY=h,a.getContainerX=l,a.getContainerWidth=d,a.getContainerHeight=c,a.resizeToSizeOfContainer=u,a.getRandomXWithinContainer=g,a.getRandomYWithinContainer=p,a.getXCenterWithinContainer=y,a.getYCenterWithinContainer=m,a.getWorldCentre=f,a.getWorldPos=v},{}],12:[function(e,t,a){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function n(e){if(null!=PiecSettings.pngAnimations)for(var t in PiecSettings.pngAnimations){var a=PiecSettings.pngAnimations[t];o(e,a)}}function o(e,t){var a=t.src.substr(0,t.src.indexOf("."));e.load.spritesheet(a,PiecSettings.assetsDir+t.src,t.spriteWidth,t.spriteHeight,t.spriteNumber)}function s(e,t,a,i){var n=PiecSettings.pngAnimations[t],o=n.src.substr(0,n.src.indexOf("."));if(null!=n.htmlContainer){var s=document.getElementById(n.htmlContainer),r=s.offsetWidth*window.devicePixelRatio;s.offsetHeight,window.devicePixelRatio,s.getBoundingClientRect().left,window.devicePixelRatio,s.getBoundingClientRect().top,window.devicePixelRatio}var l=e.add.sprite(0,0,o);if(l.animations.add("animation"),l.alpha=0,null==n.loopReverse&&(n.loopReverse=!1),null!=n.isReversed&&n.isReversed&&(l.animations.currentAnim.isReversed=!0),i){h.initSignal().add(function(e){i(a,e)},this)}if(h.playAnimation(e,l,n.delay,n.fps,n.loopReverse,n.loops),null!=n.angle&&0!=n.angle){var d=0;this.game.global.windowWidth>this.game.global.windowHeight&&null!=n.responsiveAngle&&n.responsiveAngle&&(d=90),l.anchor.set(.5),l.angle=n.angle+d}if(void 0!==n.htmlContainer&&(l.scale.x=r/l.width,l.scale.y=l.scale.x,l.persistent=!1),void 0!==n.persistent&&(l.persistent=n.persistent),void 0!==n.loops&&(l.numberOfLoops=n.loops,l.animations.currentAnim.onLoop.add(h.onLoop,this)),void 0!==n.effect&&-1!=n.effect.indexOf("fade-in")){l.alpha=0;e.add.tween(l).to({alpha:1},1e3,Phaser.Easing.Linear.None,!0,n.delay)}return l}Object.defineProperty(a,"__esModule",{value:!0}),a.preloadPngSequences=n,a.playPngSequence=s;var r=e("../utils/animations-util.js"),h=i(r),l=e("../utils/container-util");i(l)},{"../utils/animations-util.js":10,"../utils/container-util":11}],13:[function(e,t,a){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function n(e,t,a,i,n,o){for(var s=0;s<o;s++){var h=r(e,t);u.fitInContainer(h,a,.5,.5),h.x=i,h.y=n;var l=.1*Math.random()+1;h.scale.x*=l,h.scale.y=h.scale.x;var d=90*Math.random();h.angle=d,e.add.existing(h);var c=100*Math.random(),g=600+200*Math.random(),y=Math.random()-.5,m=h.y-h.height*(3*Math.random()),f=p.moveTo(h,h.x+y*h.width*15,[m,m+h.height*(7*Math.random())],c,g,Phaser.Easing.Quadratic.Out);h.tween=f,e.add.tween(h).to({angle:d+25*y+100*(y<0?-1:1)},g,Phaser.Easing.Quadratic.InOut,!0,c),p.scaleOut(h,g-200,200,Phaser.Easing.Quadratic.InOut),f.onComplete.add(function(e){e.destroy()})}}function o(e,t,a,i,n,o,s){for(var h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:10,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:40,d=0;d<s;d++){var c=r(e,t);u.fitInContainer(c,a,.5,.5),c.x=n,c.y=o;var g=.5*Math.random()+.5;c.scale.x*=g,c.scale.y=c.scale.x;var y=90*Math.random();c.angle=y,e.add.existing(c);var m=100*Math.random(),f=1500+200*Math.random(),v=Math.random()-.5,w=c.y-c.height*(Math.random()*h),C=-1,b=-1;if(void 0!==i&&(C=u.getContainerX(i),b=u.getContainerY(i)),-1!=C&&-1!=b){var x=p.moveTo(c,[c.x+v*c.width*l,c.x+v*c.width*l*5,C+Math.random()*c.width*10],[w,w+c.height*(30*Math.random()),b+Math.random()*c.height*10],m,f,Phaser.Easing.Quadratic.Out).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});c.tween=x}else if(h>0){var x=p.moveTo(c,c.x+v*c.width*l,[w,w+c.height*(30*Math.random())],m,f,Phaser.Easing.Quadratic.Out).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});c.tween=x}else{var x=p.moveTo(c,c.x+v*c.width*l,w+c.height*(30*Math.random()),m,f,Phaser.Easing.Quadratic.Out).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});c.tween=x}e.add.tween(c).to({angle:y+25*v+100*(v<0?-1:1)},f,Phaser.Easing.Quadratic.InOut,!0,m),p.scaleOut(c,f-100,100,Phaser.Easing.Quadratic.InOut),x.onComplete.add(function(e){e.destroy()})}}function s(e,t,a,i,n,o,s,h){for(var l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,d=0;d<o;d++){var c=r(e,t);u.fitInContainer(c,a,.5,.5),c.x=i,c.y=n;var g=.5*Math.random()+1;c.scale.x*=g,c.scale.y=c.scale.x;var y=90*Math.random();c.angle=y,e.add.existing(c);var m=100*Math.random(),f=600+200*Math.random(),v=p.moveTo(c,c.x+s*c.width*(Math.random()+l),c.y+h*c.height*(Math.random()+l),m,f,Phaser.Easing.Quadratic.Out);c.tween=v,e.add.tween(c).to({angle:y+25*s+100*(s<0?-1:1)},f,Phaser.Easing.Quadratic.InOut,!0,m);var w=c.scale.x;c.scale.x=.2*w,c.scale.y=.2*w,e.add.tween(c.scale).to({x:[w,w,w,.01],y:[w,w,w,.01]},f,Phaser.Easing.Quadratic.InOut,!0,0),v.onComplete.add(function(e){e.destroy()})}}function r(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t[Math.min(Math.floor(Math.random()*t.length),t.length-1)];return a?m.playPngSequence(e,i,null):new Phaser.Sprite(e,0,0,i)}function h(e,t,a,i,n,o){for(var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:360,r=[],h=0;h<o;h++){var l=d(e,t,a,i,n,s);r.push(l)}return r}function l(e,t,a,i,n,o,s){for(var h=(arguments.length>7&&void 0!==arguments[7]&&arguments[7],[]),l=u.getContainerWidth(i)/2,d=0,c=2*Math.PI/s,g=0;g<s;g++){var p=r(e,t);u.fitInContainer(p,a,.5,.5),p.angle=90+360/s*g,h.push(p),e.add.existing(p),p.x=n,p.y=o;var y=p.scale.x,m=p.x+l*Math.cos(d),f=p.y+l*Math.sin(d);d+=c,e.add.tween(p).to({x:m,y:f},400,Phaser.Easing.Quadratic.Out,!0,0),p.scale.x=.1*y,e.add.tween(p.scale).to({x:[y,0],y:[y,0]},400,Phaser.Easing.Quadratic.Out,!0,0)}return h}function d(e,t,a,i,n){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:360,s=r(e,t),h=Math.random()-.5,l=Math.random()-.5;u.fitInContainer(s,a,.5,.5),s.x=i+h*s.width,s.y=n+l*s.width;var d=.1*Math.random()+1;s.scale.x*=d,s.scale.y=s.scale.x;var c=Math.random()*o;return s.angle=c,e.add.existing(s),s}Object.defineProperty(a,"__esModule",{value:!0}),a.particleBurst=n,a.particleRain=o,a.particleShoot=s,a.particleSpawn=h,a.particleExplosion=l;var c=e("../utils/container-util"),u=i(c),g=e("../utils/tweener"),p=i(g),y=e("../utils/custom-png-sequences-renderer"),m=i(y)},{"../utils/container-util":11,"../utils/custom-png-sequences-renderer":12,"../utils/tweener":14}],14:[function(e,t,a){"use strict";function i(e,t,a,i,n,o,s){var r=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(null==e||null===e.game)return null;var h=document.getElementById(t),l=h.offsetWidth*window.devicePixelRatio,d=l*e.anchor.x,c=h.getBoundingClientRect().left*window.devicePixelRatio+d,u=l/(e.width/e.scale.x),g=h.offsetHeight*window.devicePixelRatio,p=g*e.anchor.y,y=h.getBoundingClientRect().top*window.devicePixelRatio+p;r&&e.height/e.scale.y*u>g&&(u=g/(e.height/e.scale.y));var m=e.game.add.tween(e).to({x:c,y:y},i,n,void 0===s||s,a);return e.game.add.tween(e.scale).to({x:u,y:u},i,n,void 0===s||s,a),o&&m.onComplete.add(o,this),m}function n(e,t,a,i,n,o,s,r){if(null===e||null===e.game)return null;var h=e.game.add.tween(e).to({x:t,y:a},n,o,void 0===r||r,i);return s&&h.onComplete.add(s,this),h}function o(e,t,a,i,n,o,s){if(null===e||null===e.game)return null;var r={};null!==t&&(r={alpha:t});var h=e.game.add.tween(e).to(r,0===i?1:i,n,void 0===o||o,a);return s&&h.onComplete.add(s,this),h}function s(e,t,a,i,n,o){return this.fade(e,1,t,a,i,n,o)}function r(e,t,a,i,n,o){return this.fade(e,0,t,a,i,n,o)}function h(e,t,a,i,n,o,s){if(null===e||null===e.game)return null;var r=e.game.add.tween(e.scale).to({x:t,y:a},n,o,!0,i);return s&&r.onComplete.add(s,this),r}function l(e,t,a,i,n,o){if(null===e||null===e.game)return null;var s=document.getElementById(t),r=s.getBoundingClientRect(),h=this.getScaleFromDom(t,e);this.moveTo(e,(r.left+.5*r.width)*window.devicePixelRatio,(r.top+.5*r.height)*window.devicePixelRatio,a,i,n,o),this.scaleTo(e,h,h,a,i,n)}function d(e,t){var a=document.getElementById(e),i=a.getBoundingClientRect(),n=i.width*window.devicePixelRatio/t._frame.width;return!1==t._frame.height*n<=i.height*window.devicePixelRatio&&(n=i.height*window.devicePixelRatio/t._frame.height),n}function c(e,t,a){if(null===e||null===e.game)return null;e.game.add.tween(e.scale).to({x:1.2*e.scale.x,y:1.2*e.scale.x},a,Phaser.Easing.Quadratic.InOut,!0,t,-1,!0)}function u(e,t,a){if(null===e||null===e.game)return null;var i=e.scale.x,n=e.scale.y;e.angle=0,e.scale.x=0,e.scale.y=0,e.game.add.tween(e.scale).to({x:i,y:n},a,Phaser.Easing.Quadratic.InOut,!0,t),e.game.add.tween(e).to({angle:360},a,Phaser.Easing.Back.InOut,!0,t)}function g(e,t,a,i,n){if(null===e||null===e.game)return null;a=e.scale.x*a,i=e.scale.x*i;var o=e.game.add.tween(e.scale).to({x:a,y:a},500,Phaser.Easing.Quadratic.Out,!0,0),s=e.game.add.tween(e.scale).to({x:i,y:i},500,Phaser.Easing.Quadratic.In,!1,0);o.chain(s);var r=e.game.add.tween(e).to({angle:15},500,function(e){return Math.sin(2*Math.PI*e)},!0,0,1);n&&r.onComplete.add(function(){n(e)},this)}function p(e,t,a,i){var n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=e.scale.x,s=e.scale.y;e.game.add.tween(e.scale).to({x:o*(t||1.1),y:s*(a||.9)},i||800,Phaser.Easing.Linear.None,!0,delay,-1).yoyo(n,0)}function y(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments[4],o=arguments[5];t=t||10;var s=e.angle,r=s+t;e.angle-=t,null!=n&&(e.anchor.x=n),null!=o&&(e.anchor.y=o),e.game.add.tween(e).to({angle:r
},a,Phaser.Easing.Linear.None,!0,i,-1).yoyo(!0,0)}function m(e,t,a,i,n){var o=e.scale.x,s=e.scale.y;e.scale.x=.001,e.scale.y=.001,"function"==typeof e.show?e.show():e.alpha=1;var r=e.game.add.tween(e.scale).to({x:o,y:s},a||800,i,!0,t||0);return n&&r.onComplete.add(function(){n(e)},this),r}function f(e,t,a,i,n){var o=e.scale.x,s=e.game.add.tween(e.scale).to({x:.001,y:.001},a||800,i,!0,t||0);return n?s.onComplete.add(function(){"function"==typeof e.hide?e.hide():e.alpha=0,e.scale.x=o,e.scale.y=o,n(e)},this):s.onComplete.add(function(){"function"==typeof e.hide?e.hide():e.alpha=0,e.scale.x=o,e.scale.y=o},this),s}function v(e,t,a,i,n){var o=.3*n;e.alpha=0;var s=e.game.add.tween(e).to({alpha:1},o,Phaser.Easing.Linear.None,!0,i||0),r=e.game.add.tween(e).to({alpha:0},o,Phaser.Easing.Linear.None,!1,n-2*o);s.chain(r),e.game.add.tween(e).to({x:t,y:a},n,Phaser.Easing.Quadratic.Out,!0,i||0)}function w(e,t,a){var i=.3*a,n=.15*a,o=e.scale.x,s=e.scale.y;e.scale.x=0,e.scale.y=0,e.game.add.tween(e.scale).to({x:o,y:s},n,Phaser.Easing.Quadratic.In,!0,t||0),e.game.add.tween(e).to({alpha:0},i,Phaser.Easing.Linear.None,!0,a-n)}function C(e,t,a,i){e.game.add.tween(e).to({angle:[-5,-5,0]},a,i,!0,t);var n=e.scale.x;return e.game.add.tween(e.scale).to({x:[.9*n,.9*n,n],y:[.9*n,.9*n,n]},a,i,!0,t)}function b(e,t,a,i,n){e.angle=t,e.game.add.tween(e).to({angle:[t+10,t+5,t-5,t-5,t]},i,n,!0,a);var o=e.scale.x;return e.game.add.tween(e.scale).to({x:[o,o,.9*o,.9*o,o],y:[o,o,.9*o,.9*o,o]},i,n,!0,a)}function x(e,t,a,i){e.game.add.tween(e).to({angle:-10},a,i,!0,t);var n=e.scale.x;return e.game.add.tween(e.scale).to({x:[1.05*n,.9*n],y:[1.05*n,.9*n]},a,i,!0,t)}function P(e,t,a,i){var n,o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"up",h=e.y,l=e.x,d=e.scale.x,c=20,u=0;switch(r){case"up":n=.5*-e.width,o=2*e.height*-1,u=-20,c=-10;break;case"down":n=.1*e.width,o=1.2*e.height,u=20,c=-10;break;case"left":n=1.2*e.width*-1,o=.1*e.height,u=20,c=20;break;case"right":n=1.2*e.width,o=.1*e.height,u=-20;break;case"upleft":n=1.2*e.width*-1,o=1.2*e.height*-1,u=20,c=40;break;case"upright":n=1.2*e.width,o=1.2*e.height*-1,u=-20,c=-20;break;case"downleft":n=1.2*e.width*-1,o=1.2*e.height,u=20,c=-10;break;case"downright":n=1.2*e.width,o=1.2*e.height,u=-15,c=-5}e.game.add.tween(e).to({angle:[c+u,c,c-u],y:[h,h+o/2,h+o],x:[l,l+n/2,l+n]},a,i,!0,t).onComplete.add(function(){e.game.add.tween(e).to({angle:0,x:l,y:h},s-200,i,!0,150)},this),e.game.add.tween(e.scale).to({x:[.8*d,.8*d],y:[.8*d,.8*d]},a,i,!0,t).onComplete.add(function(){null!=e&&null!=e.game&&e.game.add.tween(e.scale).to({x:d,y:d},150,i,!0,0)},this)}function _(e,t,a,i,n,o,s){var r=i*e.width,h=t,l=a;return e.game.add.tween(e).to({x:[h,h+r*Math.cos(Math.PI/4),h+r,h+r*Math.cos(Math.PI/4),h,h-r*Math.cos(Math.PI/4),h-r,h-r*Math.cos(Math.PI/4),h],y:[l-r,l-r*Math.sin(Math.PI/4),l,l+r*Math.sin(Math.PI/4),l+r,l+r*Math.sin(Math.PI/4),l,l-r*Math.sin(Math.PI/4),l-r],angle:[0,-50,0,50,0]},o,s,!0,n).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)})}function S(e,t,a,i){var n=.5*e.height,o=e.y,s=e.x,r=e.scale.x;e.game.add.tween(e).to({angle:[10,0,-10],y:[o,o+n/2,o+n],x:[s,s+0,s+0]},a,i,!0,t).onComplete.add(function(){e.game.add.tween(e).to({angle:0,x:s,y:o},a/2,i,!0,500)},this),e.game.add.tween(e.scale).to({x:[.9*r,.9*r],y:[.9*r,.9*r]},a,i,!0,t).onComplete.add(function(){e.game.add.tween(e.scale).to({x:r,y:r},500,i,!0,0)},this)}function M(e,t,a,i){var n=2*e.height*-1;return this.slideIn(e,0,n,t,a,i)}function k(e,t,a,i){var n=2*e.height;return this.slideIn(e,0,n,t,a,i)}function O(e,t,a,i){var n=2*e.width;return this.slideIn(e,n,0,t,a,i)}function A(e,t,a,i){var n=2*e.width*-1;return this.slideIn(e,n,0,t,a,i)}function T(e,t,a,i,n,o){var s=e.x,r=e.y;return e.x+=t,e.y+=a,this.fadeIn(e,i,n/2,Phaser.Easing.Quadratic.InOut),e.game.add.tween(e).to({x:s,y:r},n,o,!0,i)}function I(e,t,a,i){var n=e.scale.x;return e.game.add.tween(e.scale).to({x:1.1*n,y:1.1*n},a,i,!0,t).loop(!0).yoyo(!0)}function E(e,t,a,i){var n=e.scale.x;return e.game.add.tween(e.scale).to({x:1.1*n,y:1.1*n},a,i,!0,t).yoyo(!0)}function R(e,t,a,i){var n=e.scale.x;return e.scale.x=1.1*n,e.scale.y=.9*n,e.game.add.tween(e.scale).to({x:n,y:n},a,i,!0,t)}function D(e,t,a,i,n,o){var s=e.scale.x;return e.game.add.tween(e.scale).to({x:[1.1*s,s,0],y:[1.1*s,s,0]},n,o,!0,0),e.game.add.tween(e).to({x:t,y:a,angle:[10,0,-10,0,0]},n,o,!0,0)}Object.defineProperty(a,"__esModule",{value:!0}),a.moveToContainer=i,a.moveTo=n,a.fade=o,a.fadeIn=s,a.fadeOut=r,a.scaleTo=h,a.moveToDom=l,a.getScaleFromDom=d,a.bulge=c,a.spinIn=u,a.wobbleScaleIn=g,a.jiggle=p,a.jiggleAngle=y,a.scaleIn=m,a.scaleOut=f,a.fadeFloat=v,a.scaleThenFade=w,a.quickTap=C,a.tap=b,a.tapAndHold=x,a.swipe=P,a.circleAround=_,a.smallSwipeUpDown=S,a.slideInDown=M,a.slideInUp=k,a.slideInLeft=O,a.slideInRight=A,a.slideIn=T,a.pulse=I,a.pulseOnce=E,a.rubberBand=R,a.scaleAndFlyToGoal=D},{}],15:[function(e,t,a){"use strict";function i(e,t){return t||(t=0),Math.floor(Math.random()*(e-t+1))+t}function n(e){return e[this.rndInt(e.length-1,0)]}function o(e){return e||(e=1),"rgba("+this.rndInt(256)+","+this.rndInt(256)+","+this.rndInt(256)+","+e+")"}function s(){return document.body.clientHeight>document.body.clientWidth}function r(){return s()?"portrait":"landscape"}function h(e){return JSON.parse(JSON.stringify(e))}function l(e,t){var a=e.indexOf(t);a>-1&&e.splice(a,1)}function d(e){return-1===e.lastIndexOf(".")?e:e.substring(0,e.lastIndexOf("."))}function c(e){e.style.opacity=0;var t=+new Date;!function a(){e.style.opacity=+e.style.opacity+(new Date-t)/400,t=+new Date,+e.style.opacity<1&&(window.requestAnimationFrame&&requestAnimationFrame(a)||setTimeout(a,16))}()}function u(e){return 100*Math.sqrt(2*Math.abs(e)/_)}function g(e){var t={boolean:{},number:{},string:{}},a=[];return e.filter(function(e){var i=void 0===e?"undefined":P(e);return i in t?!t[i].hasOwnProperty(e)&&(t[i][e]=!0):!(a.indexOf(e)>=0)&&a.push(e)})}function p(e,t){var a,i={};for(a in e)Object.prototype.hasOwnProperty.call(e,a)&&(i[a]=e[a]);for(a in t)Object.prototype.hasOwnProperty.call(t,a)&&(i[a]=t[a]);return i}function y(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function m(e,t){var a=document.getElementById(e),i=a.getBoundingClientRect(),n=i.width*window.devicePixelRatio/t._frame.sourceSizeW;t.scale.x=n,t.scale.y=n,!1==t._frame.sourceSizeH*n<=i.height*window.devicePixelRatio&&(n=i.height*window.devicePixelRatio/t._frame.sourceSizeH,t.scale.x=n,t.scale.y=n),t.anchor.set(.5,.5),t.x=(i.left+.5*i.width)*window.devicePixelRatio,t.y=(i.top+.5*i.height)*window.devicePixelRatio}function f(e,t,a,i){return 180*Math.atan2(i-t,a-e)/Math.PI}function v(e){switch(e){case"Linear":return Phaser.Easing.Linear.None;case"BackIn":return Phaser.Easing.Back.In;case"BackOut":return Phaser.Easing.Back.Out;case"BounceIn":return Phaser.Easing.Bounce.In;case"BounceOut":return Phaser.Easing.Bounce.Out;case"CircularIn":return Phaser.Easing.Circular.In;case"CircularOut":return Phaser.Easing.Circular.Out;case"CubicIn":return Phaser.Easing.Cubic.In;case"CubicOut":return Phaser.Easing.Cubic.Out;case"ElasticIn":return Phaser.Easing.Elastic.In;case"ElasticOut":return Phaser.Easing.Elastic.Out;case"ExponentialIn":return Phaser.Easing.Exponential.In;case"ExponentialOut":return Phaser.Easing.Exponential.Out;case"QuadraticIn":return Phaser.Easing.Quadratic.In;case"QuadraticOut":return Phaser.Easing.Quadratic.Out;case"QuarticIn":return Phaser.Easing.Quartic.In;case"QuarticOut":return Phaser.Easing.Quartic.Out;case"QuinticIn":return Phaser.Easing.Quintic.In;case"QuinticOut":return Phaser.Easing.Quintic.Out;case"SinusoidalIn":return Phaser.Easing.Sinusoidal.In;case"SinusoidalOut":return Phaser.Easing.Sinusoidal.Out}console.error('unkown easing value "'+e+'"')}function w(e,t){for(var a in t)e[a]=t[a];return e}function C(){var e;return navigator.userLanguage?(e=navigator.userLanguage,-1==e.indexOf("zh")&&(e=e.split("-")[0].toLowerCase())):navigator.language?(e=navigator.language,-1==e.indexOf("zh")&&(e=e.split("-")[0].toLowerCase())):(e="en",void 0!==PiecSettings.defaultLang&&(e=PiecSettings.defaultLang)),e=e.toLowerCase(),console.log(e),-1!==e.indexOf("zh")&&(e="zh-tw"==e||"zh-hk"==e?"zh-traditional":"zh"),e}function b(){var e=navigator.userAgent||navigator.vendor||window.opera,t=null;return/windows phone/i.test(e)&&(t="windowsPhone"),/android/i.test(e)&&(t="android"),/iPad|iPhone|iPod/.test(e)&&!window.MSStream&&(t="ios"),t}function x(){return"#"+((1<<24)*(Math.random()+1)|12632256).toString(16).substr(1)}Object.defineProperty(a,"__esModule",{value:!0});var P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};a.rndInt=i,a.sample=n,a.rndRgba=o,a.isPortrait=s,a.getOrientation=r,a.clone=h,a.remove=l,a.removeExtension=d,a.fadeIn=c,a.calcQuadTime=u,a.uniq=g,a.extend=p,a.numberWithCommas=y,a.animToDom=m,a.getAngleBetweenTwoPoints=f,a.getEasing=v,a.JSONmerge=w,a.getDeviceLang=C,a.getDeviceOS=b,a.getRandomColor=x;var _=19.8},{}]},{},[1]);
